import{s}from"./supabaseClient-Db4K6C7q.js";document.addEventListener("DOMContentLoaded",async()=>{console.log("Landing page loaded successfully.");const{data:{session:e}}=await s.auth.getSession();if(e){document.getElementById("logged-out-view").style.display="none",document.getElementById("logged-in-view").style.display="block",document.getElementById("nav-dashboard").style.display="block",document.getElementById("nav-prompts").style.display="block",document.getElementById("nav-login").style.display="none",document.getElementById("nav-logout").style.display="block";const n=document.getElementById("user-email-display");n.textContent=e.user.email,document.getElementById("nav-user-email").style.display="block";const o=document.getElementById("nav-divider");o&&o.style.setProperty("display","flex","important"),await i(),u()}else document.getElementById("logged-out-view").style.display="flex",document.getElementById("logged-in-view").style.display="none";const t=document.getElementById("logout-btn");t&&t.addEventListener("click",async n=>{n.preventDefault(),await s.auth.signOut(),window.location.reload()})});async function i(){try{const{data:{session:e}}=await s.auth.getSession();if(!e)return;const t=e.user.id,{count:n,error:o}=await s.from("categories").select("*",{count:"exact",head:!0}).eq("user_id",t);if(o)throw o;const{count:l,error:r}=await s.from("prompts").select("*",{count:"exact",head:!0}).eq("user_id",t);if(r)throw r;const a=new Date;a.setDate(a.getDate()-7);const{count:c,error:d}=await s.from("prompts").select("*",{count:"exact",head:!0}).eq("user_id",t).gte("created_at",a.toISOString());if(d)throw d;document.getElementById("stat-categories").textContent=n||0,document.getElementById("stat-prompts").textContent=l||0,document.getElementById("stat-recent").textContent=c||0}catch(e){console.error("Error fetching dashboard stats:",e.message)}}function u(){const e=document.getElementById("global-search-form"),t=document.getElementById("global-search-input");e.addEventListener("submit",n=>{n.preventDefault();const o=t.value.trim();o&&(window.location.href=`../prompts/prompts.html?search=${encodeURIComponent(o)}`)})}
