import{s as c}from"./supabaseClient-8CxNeXQr.js";/* empty css               */import{i as A}from"./roles-BbqFL7ZG.js";document.addEventListener("DOMContentLoaded",()=>{const i=document.getElementById("main-navbar"),g=document.getElementById("nav-dashboard"),y=document.getElementById("nav-admin"),v=document.getElementById("nav-home"),p=document.getElementById("nav-categories"),h=document.getElementById("nav-explore"),f=document.getElementById("nav-login-item"),B=document.getElementById("nav-register-item"),b=document.getElementById("nav-logout-item"),E=document.getElementById("logoutBtn"),I=document.getElementById("authForm"),x=document.getElementById("formTitle"),n=document.getElementById("submitBtn"),r=document.getElementById("toggleModeBtn"),w=document.getElementById("toggleText"),o=document.getElementById("alertArea");let s=!0;async function k(){var d;const{data:{session:e},error:t}=await c.auth.getSession();!t&&!!e&&((d=e==null?void 0:e.user)!=null&&d.id)?(v.style.display="block",p.style.display="block",h.style.display="block",g.style.display="block",y.style.display=await A(e.user.id)?"block":"none",f.style.display="none",B.style.display="none",b.style.display="block",i&&i.classList.remove("navbar-guest-mode")):(v.style.display="block",p.style.display="block",h.style.display="block",g.style.display="none",y.style.display="none",f.style.display="block",B.style.display="block",b.style.display="none",i&&i.classList.add("navbar-guest-mode"))}k(),E&&E.addEventListener("click",async e=>{e.preventDefault();const{error:t}=await c.auth.signOut();t?l("Failed to log out.","danger"):window.location.href="../../index.html"});function L(){s?(x.textContent="Login",n.textContent="Login",w.textContent="Don't have an account?",r.textContent="Register here"):(x.textContent="Register",n.textContent="Register",w.textContent="Already have an account?",r.textContent="Login here")}new URLSearchParams(window.location.search).get("mode")==="register"&&(s=!1),L();function l(e,t){o.textContent=e,o.className=`alert alert-${t} mt-3`,o.classList.remove("d-none")}function C(){o.classList.add("d-none"),o.textContent=""}r.addEventListener("click",e=>{e.preventDefault(),s=!s,L(),C(),I.reset()}),I.addEventListener("submit",async e=>{e.preventDefault();const t=document.getElementById("email").value,m=document.getElementById("password").value,d=n.textContent;n.disabled=!0,n.textContent="Processing...",C();try{if(s){const{data:u,error:a}=await c.auth.signInWithPassword({email:t,password:m});if(a)throw a;l("Login successful! Redirecting...","success"),setTimeout(()=>{window.location.href="../../index.html"},1e3)}else{const{data:u,error:a}=await c.auth.signUp({email:t,password:m});if(a)throw a;l("Registration successful! Redirecting...","success"),setTimeout(()=>{window.location.href="../../index.html"},1e3)}}catch(u){l(u.message,"danger"),n.disabled=!1,n.textContent=d}})});
