(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();var Vl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zl={exports:{}};/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(s,e){(function(t,i){s.exports=i()})(Vl,function(){const t=new Map,i={set(c,r,a){t.has(c)||t.set(c,new Map);const h=t.get(c);h.has(r)||h.size===0?h.set(r,a):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(h.keys())[0]}.`)},get:(c,r)=>t.has(c)&&t.get(c).get(r)||null,remove(c,r){if(!t.has(c))return;const a=t.get(c);a.delete(r),a.size===0&&t.delete(c)}},n="transitionend",o=c=>(c&&window.CSS&&window.CSS.escape&&(c=c.replace(/#([^\s"#']+)/g,(r,a)=>`#${CSS.escape(a)}`)),c),l=c=>c==null?`${c}`:Object.prototype.toString.call(c).match(/\s([a-z]+)/i)[1].toLowerCase(),u=c=>{c.dispatchEvent(new Event(n))},d=c=>!(!c||typeof c!="object")&&(c.jquery!==void 0&&(c=c[0]),c.nodeType!==void 0),f=c=>d(c)?c.jquery?c[0]:c:typeof c=="string"&&c.length>0?document.querySelector(o(c)):null,g=c=>{if(!d(c)||c.getClientRects().length===0)return!1;const r=getComputedStyle(c).getPropertyValue("visibility")==="visible",a=c.closest("details:not([open])");if(!a)return r;if(a!==c){const h=c.closest("summary");if(h&&h.parentNode!==a||h===null)return!1}return r},b=c=>!c||c.nodeType!==Node.ELEMENT_NODE||!!c.classList.contains("disabled")||(c.disabled!==void 0?c.disabled:c.hasAttribute("disabled")&&c.getAttribute("disabled")!=="false"),y=c=>{if(!document.documentElement.attachShadow)return null;if(typeof c.getRootNode=="function"){const r=c.getRootNode();return r instanceof ShadowRoot?r:null}return c instanceof ShadowRoot?c:c.parentNode?y(c.parentNode):null},_=()=>{},w=c=>{c.offsetHeight},S=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,O=[],C=()=>document.documentElement.dir==="rtl",P=c=>{var r;r=()=>{const a=S();if(a){const h=c.NAME,p=a.fn[h];a.fn[h]=c.jQueryInterface,a.fn[h].Constructor=c,a.fn[h].noConflict=()=>(a.fn[h]=p,c.jQueryInterface)}},document.readyState==="loading"?(O.length||document.addEventListener("DOMContentLoaded",()=>{for(const a of O)a()}),O.push(r)):r()},T=(c,r=[],a=c)=>typeof c=="function"?c.call(...r):a,q=(c,r,a=!0)=>{if(!a)return void T(c);const h=(v=>{if(!v)return 0;let{transitionDuration:E,transitionDelay:A}=window.getComputedStyle(v);const I=Number.parseFloat(E),x=Number.parseFloat(A);return I||x?(E=E.split(",")[0],A=A.split(",")[0],1e3*(Number.parseFloat(E)+Number.parseFloat(A))):0})(r)+5;let p=!1;const m=({target:v})=>{v===r&&(p=!0,r.removeEventListener(n,m),T(c))};r.addEventListener(n,m),setTimeout(()=>{p||u(r)},h)},re=(c,r,a,h)=>{const p=c.length;let m=c.indexOf(r);return m===-1?!a&&h?c[p-1]:c[0]:(m+=a?1:-1,h&&(m=(m+p)%p),c[Math.max(0,Math.min(m,p-1))])},J=/[^.]*(?=\..*)\.|.*/,ie=/\..*/,$e=/::\d+$/,ge={};let Gr=1;const Jr={mouseenter:"mouseover",mouseleave:"mouseout"},So=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Yr(c,r){return r&&`${r}::${Gr++}`||c.uidEvent||Gr++}function Xr(c){const r=Yr(c);return c.uidEvent=r,ge[r]=ge[r]||{},ge[r]}function Qr(c,r,a=null){return Object.values(c).find(h=>h.callable===r&&h.delegationSelector===a)}function Zr(c,r,a){const h=typeof r=="string",p=h?a:r||a;let m=ti(c);return So.has(m)||(m=c),[h,p,m]}function ei(c,r,a,h,p){if(typeof r!="string"||!c)return;let[m,v,E]=Zr(r,a,h);r in Jr&&(v=(B=>function(U){if(!U.relatedTarget||U.relatedTarget!==U.delegateTarget&&!U.delegateTarget.contains(U.relatedTarget))return B.call(this,U)})(v));const A=Xr(c),I=A[E]||(A[E]={}),x=Qr(I,v,m?a:null);if(x)return void(x.oneOff=x.oneOff&&p);const R=Yr(v,r.replace(J,"")),F=m?function(D,B,U){return function M(Y){const Z=D.querySelectorAll(B);for(let{target:H}=Y;H&&H!==this;H=H.parentNode)for(const V of Z)if(V===H)return Vs(Y,{delegateTarget:H}),M.oneOff&&k.off(D,Y.type,B,U),U.apply(H,[Y])}}(c,a,v):function(D,B){return function U(M){return Vs(M,{delegateTarget:D}),U.oneOff&&k.off(D,M.type,B),B.apply(D,[M])}}(c,v);F.delegationSelector=m?a:null,F.callable=v,F.oneOff=p,F.uidEvent=R,I[R]=F,c.addEventListener(E,F,m)}function Ks(c,r,a,h,p){const m=Qr(r[a],h,p);m&&(c.removeEventListener(a,m,!!p),delete r[a][m.uidEvent])}function To(c,r,a,h){const p=r[a]||{};for(const[m,v]of Object.entries(p))m.includes(h)&&Ks(c,r,a,v.callable,v.delegationSelector)}function ti(c){return c=c.replace(ie,""),Jr[c]||c}const k={on(c,r,a,h){ei(c,r,a,h,!1)},one(c,r,a,h){ei(c,r,a,h,!0)},off(c,r,a,h){if(typeof r!="string"||!c)return;const[p,m,v]=Zr(r,a,h),E=v!==r,A=Xr(c),I=A[v]||{},x=r.startsWith(".");if(m===void 0){if(x)for(const R of Object.keys(A))To(c,A,R,r.slice(1));for(const[R,F]of Object.entries(I)){const D=R.replace($e,"");E&&!r.includes(D)||Ks(c,A,v,F.callable,F.delegationSelector)}}else{if(!Object.keys(I).length)return;Ks(c,A,v,m,p?a:null)}},trigger(c,r,a){if(typeof r!="string"||!c)return null;const h=S();let p=null,m=!0,v=!0,E=!1;r!==ti(r)&&h&&(p=h.Event(r,a),h(c).trigger(p),m=!p.isPropagationStopped(),v=!p.isImmediatePropagationStopped(),E=p.isDefaultPrevented());const A=Vs(new Event(r,{bubbles:m,cancelable:!0}),a);return E&&A.preventDefault(),v&&c.dispatchEvent(A),A.defaultPrevented&&p&&p.preventDefault(),A}};function Vs(c,r={}){for(const[a,h]of Object.entries(r))try{c[a]=h}catch{Object.defineProperty(c,a,{configurable:!0,get:()=>h})}return c}function si(c){if(c==="true")return!0;if(c==="false")return!1;if(c===Number(c).toString())return Number(c);if(c===""||c==="null")return null;if(typeof c!="string")return c;try{return JSON.parse(decodeURIComponent(c))}catch{return c}}function zs(c){return c.replace(/[A-Z]/g,r=>`-${r.toLowerCase()}`)}const Ue={setDataAttribute(c,r,a){c.setAttribute(`data-bs-${zs(r)}`,a)},removeDataAttribute(c,r){c.removeAttribute(`data-bs-${zs(r)}`)},getDataAttributes(c){if(!c)return{};const r={},a=Object.keys(c.dataset).filter(h=>h.startsWith("bs")&&!h.startsWith("bsConfig"));for(const h of a){let p=h.replace(/^bs/,"");p=p.charAt(0).toLowerCase()+p.slice(1),r[p]=si(c.dataset[h])}return r},getDataAttribute:(c,r)=>si(c.getAttribute(`data-bs-${zs(r)}`))};class qt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(r){return r=this._mergeConfigObj(r),r=this._configAfterMerge(r),this._typeCheckConfig(r),r}_configAfterMerge(r){return r}_mergeConfigObj(r,a){const h=d(a)?Ue.getDataAttribute(a,"config"):{};return{...this.constructor.Default,...typeof h=="object"?h:{},...d(a)?Ue.getDataAttributes(a):{},...typeof r=="object"?r:{}}}_typeCheckConfig(r,a=this.constructor.DefaultType){for(const[h,p]of Object.entries(a)){const m=r[h],v=d(m)?"element":l(m);if(!new RegExp(p).test(v))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${h}" provided type "${v}" but expected type "${p}".`)}}}class Oe extends qt{constructor(r,a){super(),(r=f(r))&&(this._element=r,this._config=this._getConfig(a),i.set(this._element,this.constructor.DATA_KEY,this))}dispose(){i.remove(this._element,this.constructor.DATA_KEY),k.off(this._element,this.constructor.EVENT_KEY);for(const r of Object.getOwnPropertyNames(this))this[r]=null}_queueCallback(r,a,h=!0){q(r,a,h)}_getConfig(r){return r=this._mergeConfigObj(r,this._element),r=this._configAfterMerge(r),this._typeCheckConfig(r),r}static getInstance(r){return i.get(f(r),this.DATA_KEY)}static getOrCreateInstance(r,a={}){return this.getInstance(r)||new this(r,typeof a=="object"?a:null)}static get VERSION(){return"5.3.8"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(r){return`${r}${this.EVENT_KEY}`}}const Gs=c=>{let r=c.getAttribute("data-bs-target");if(!r||r==="#"){let a=c.getAttribute("href");if(!a||!a.includes("#")&&!a.startsWith("."))return null;a.includes("#")&&!a.startsWith("#")&&(a=`#${a.split("#")[1]}`),r=a&&a!=="#"?a.trim():null}return r?r.split(",").map(a=>o(a)).join(","):null},j={find:(c,r=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(r,c)),findOne:(c,r=document.documentElement)=>Element.prototype.querySelector.call(r,c),children:(c,r)=>[].concat(...c.children).filter(a=>a.matches(r)),parents(c,r){const a=[];let h=c.parentNode.closest(r);for(;h;)a.push(h),h=h.parentNode.closest(r);return a},prev(c,r){let a=c.previousElementSibling;for(;a;){if(a.matches(r))return[a];a=a.previousElementSibling}return[]},next(c,r){let a=c.nextElementSibling;for(;a;){if(a.matches(r))return[a];a=a.nextElementSibling}return[]},focusableChildren(c){const r=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(a=>`${a}:not([tabindex^="-"])`).join(",");return this.find(r,c).filter(a=>!b(a)&&g(a))},getSelectorFromElement(c){const r=Gs(c);return r&&j.findOne(r)?r:null},getElementFromSelector(c){const r=Gs(c);return r?j.findOne(r):null},getMultipleElementsFromSelector(c){const r=Gs(c);return r?j.find(r):[]}},us=(c,r="hide")=>{const a=`click.dismiss${c.EVENT_KEY}`,h=c.NAME;k.on(document,a,`[data-bs-dismiss="${h}"]`,function(p){if(["A","AREA"].includes(this.tagName)&&p.preventDefault(),b(this))return;const m=j.getElementFromSelector(this)||this.closest(`.${h}`);c.getOrCreateInstance(m)[r]()})},ri=".bs.alert",Ao=`close${ri}`,Oo=`closed${ri}`;class Ft extends Oe{static get NAME(){return"alert"}close(){if(k.trigger(this._element,Ao).defaultPrevented)return;this._element.classList.remove("show");const r=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,r)}_destroyElement(){this._element.remove(),k.trigger(this._element,Oo),this.dispose()}static jQueryInterface(r){return this.each(function(){const a=Ft.getOrCreateInstance(this);if(typeof r=="string"){if(a[r]===void 0||r.startsWith("_")||r==="constructor")throw new TypeError(`No method named "${r}"`);a[r](this)}})}}us(Ft,"close"),P(Ft);const ii='[data-bs-toggle="button"]';class Wt extends Oe{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(r){return this.each(function(){const a=Wt.getOrCreateInstance(this);r==="toggle"&&a[r]()})}}k.on(document,"click.bs.button.data-api",ii,c=>{c.preventDefault();const r=c.target.closest(ii);Wt.getOrCreateInstance(r).toggle()}),P(Wt);const ft=".bs.swipe",Co=`touchstart${ft}`,Ro=`touchmove${ft}`,Po=`touchend${ft}`,Io=`pointerdown${ft}`,xo=`pointerup${ft}`,$o={endCallback:null,leftCallback:null,rightCallback:null},jo={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class hs extends qt{constructor(r,a){super(),this._element=r,r&&hs.isSupported()&&(this._config=this._getConfig(a),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return $o}static get DefaultType(){return jo}static get NAME(){return"swipe"}dispose(){k.off(this._element,ft)}_start(r){this._supportPointerEvents?this._eventIsPointerPenTouch(r)&&(this._deltaX=r.clientX):this._deltaX=r.touches[0].clientX}_end(r){this._eventIsPointerPenTouch(r)&&(this._deltaX=r.clientX-this._deltaX),this._handleSwipe(),T(this._config.endCallback)}_move(r){this._deltaX=r.touches&&r.touches.length>1?0:r.touches[0].clientX-this._deltaX}_handleSwipe(){const r=Math.abs(this._deltaX);if(r<=40)return;const a=r/this._deltaX;this._deltaX=0,a&&T(a>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(k.on(this._element,Io,r=>this._start(r)),k.on(this._element,xo,r=>this._end(r)),this._element.classList.add("pointer-event")):(k.on(this._element,Co,r=>this._start(r)),k.on(this._element,Ro,r=>this._move(r)),k.on(this._element,Po,r=>this._end(r)))}_eventIsPointerPenTouch(r){return this._supportPointerEvents&&(r.pointerType==="pen"||r.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const He=".bs.carousel",ni=".data-api",Lo="ArrowLeft",No="ArrowRight",Ht="next",pt="prev",gt="left",ds="right",Do=`slide${He}`,Js=`slid${He}`,Uo=`keydown${He}`,Bo=`mouseenter${He}`,Mo=`mouseleave${He}`,qo=`dragstart${He}`,Fo=`load${He}${ni}`,Wo=`click${He}${ni}`,oi="carousel",fs="active",ai=".active",li=".carousel-item",Ho=ai+li,Ko={[Lo]:ds,[No]:gt},Vo={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},zo={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class mt extends Oe{constructor(r,a){super(r,a),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=j.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===oi&&this.cycle()}static get Default(){return Vo}static get DefaultType(){return zo}static get NAME(){return"carousel"}next(){this._slide(Ht)}nextWhenVisible(){!document.hidden&&g(this._element)&&this.next()}prev(){this._slide(pt)}pause(){this._isSliding&&u(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?k.one(this._element,Js,()=>this.cycle()):this.cycle())}to(r){const a=this._getItems();if(r>a.length-1||r<0)return;if(this._isSliding)return void k.one(this._element,Js,()=>this.to(r));const h=this._getItemIndex(this._getActive());if(h===r)return;const p=r>h?Ht:pt;this._slide(p,a[r])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(r){return r.defaultInterval=r.interval,r}_addEventListeners(){this._config.keyboard&&k.on(this._element,Uo,r=>this._keydown(r)),this._config.pause==="hover"&&(k.on(this._element,Bo,()=>this.pause()),k.on(this._element,Mo,()=>this._maybeEnableCycle())),this._config.touch&&hs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const a of j.find(".carousel-item img",this._element))k.on(a,qo,h=>h.preventDefault());const r={leftCallback:()=>this._slide(this._directionToOrder(gt)),rightCallback:()=>this._slide(this._directionToOrder(ds)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new hs(this._element,r)}_keydown(r){if(/input|textarea/i.test(r.target.tagName))return;const a=Ko[r.key];a&&(r.preventDefault(),this._slide(this._directionToOrder(a)))}_getItemIndex(r){return this._getItems().indexOf(r)}_setActiveIndicatorElement(r){if(!this._indicatorsElement)return;const a=j.findOne(ai,this._indicatorsElement);a.classList.remove(fs),a.removeAttribute("aria-current");const h=j.findOne(`[data-bs-slide-to="${r}"]`,this._indicatorsElement);h&&(h.classList.add(fs),h.setAttribute("aria-current","true"))}_updateInterval(){const r=this._activeElement||this._getActive();if(!r)return;const a=Number.parseInt(r.getAttribute("data-bs-interval"),10);this._config.interval=a||this._config.defaultInterval}_slide(r,a=null){if(this._isSliding)return;const h=this._getActive(),p=r===Ht,m=a||re(this._getItems(),h,p,this._config.wrap);if(m===h)return;const v=this._getItemIndex(m),E=R=>k.trigger(this._element,R,{relatedTarget:m,direction:this._orderToDirection(r),from:this._getItemIndex(h),to:v});if(E(Do).defaultPrevented||!h||!m)return;const A=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(v),this._activeElement=m;const I=p?"carousel-item-start":"carousel-item-end",x=p?"carousel-item-next":"carousel-item-prev";m.classList.add(x),w(m),h.classList.add(I),m.classList.add(I),this._queueCallback(()=>{m.classList.remove(I,x),m.classList.add(fs),h.classList.remove(fs,x,I),this._isSliding=!1,E(Js)},h,this._isAnimated()),A&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return j.findOne(Ho,this._element)}_getItems(){return j.find(li,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(r){return C()?r===gt?pt:Ht:r===gt?Ht:pt}_orderToDirection(r){return C()?r===pt?gt:ds:r===pt?ds:gt}static jQueryInterface(r){return this.each(function(){const a=mt.getOrCreateInstance(this,r);if(typeof r!="number"){if(typeof r=="string"){if(a[r]===void 0||r.startsWith("_")||r==="constructor")throw new TypeError(`No method named "${r}"`);a[r]()}}else a.to(r)})}}k.on(document,Wo,"[data-bs-slide], [data-bs-slide-to]",function(c){const r=j.getElementFromSelector(this);if(!r||!r.classList.contains(oi))return;c.preventDefault();const a=mt.getOrCreateInstance(r),h=this.getAttribute("data-bs-slide-to");return h?(a.to(h),void a._maybeEnableCycle()):Ue.getDataAttribute(this,"slide")==="next"?(a.next(),void a._maybeEnableCycle()):(a.prev(),void a._maybeEnableCycle())}),k.on(window,Fo,()=>{const c=j.find('[data-bs-ride="carousel"]');for(const r of c)mt.getOrCreateInstance(r)}),P(mt);const Kt=".bs.collapse",Go=`show${Kt}`,Jo=`shown${Kt}`,Yo=`hide${Kt}`,Xo=`hidden${Kt}`,Qo=`click${Kt}.data-api`,Ys="show",_t="collapse",ps="collapsing",Zo=`:scope .${_t} .${_t}`,Xs='[data-bs-toggle="collapse"]',ea={parent:null,toggle:!0},ta={parent:"(null|element)",toggle:"boolean"};class vt extends Oe{constructor(r,a){super(r,a),this._isTransitioning=!1,this._triggerArray=[];const h=j.find(Xs);for(const p of h){const m=j.getSelectorFromElement(p),v=j.find(m).filter(E=>E===this._element);m!==null&&v.length&&this._triggerArray.push(p)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return ea}static get DefaultType(){return ta}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let r=[];if(this._config.parent&&(r=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(p=>p!==this._element).map(p=>vt.getOrCreateInstance(p,{toggle:!1}))),r.length&&r[0]._isTransitioning||k.trigger(this._element,Go).defaultPrevented)return;for(const p of r)p.hide();const a=this._getDimension();this._element.classList.remove(_t),this._element.classList.add(ps),this._element.style[a]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const h=`scroll${a[0].toUpperCase()+a.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(ps),this._element.classList.add(_t,Ys),this._element.style[a]="",k.trigger(this._element,Jo)},this._element,!0),this._element.style[a]=`${this._element[h]}px`}hide(){if(this._isTransitioning||!this._isShown()||k.trigger(this._element,Yo).defaultPrevented)return;const r=this._getDimension();this._element.style[r]=`${this._element.getBoundingClientRect()[r]}px`,w(this._element),this._element.classList.add(ps),this._element.classList.remove(_t,Ys);for(const a of this._triggerArray){const h=j.getElementFromSelector(a);h&&!this._isShown(h)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0,this._element.style[r]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(ps),this._element.classList.add(_t),k.trigger(this._element,Xo)},this._element,!0)}_isShown(r=this._element){return r.classList.contains(Ys)}_configAfterMerge(r){return r.toggle=!!r.toggle,r.parent=f(r.parent),r}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const r=this._getFirstLevelChildren(Xs);for(const a of r){const h=j.getElementFromSelector(a);h&&this._addAriaAndCollapsedClass([a],this._isShown(h))}}_getFirstLevelChildren(r){const a=j.find(Zo,this._config.parent);return j.find(r,this._config.parent).filter(h=>!a.includes(h))}_addAriaAndCollapsedClass(r,a){if(r.length)for(const h of r)h.classList.toggle("collapsed",!a),h.setAttribute("aria-expanded",a)}static jQueryInterface(r){const a={};return typeof r=="string"&&/show|hide/.test(r)&&(a.toggle=!1),this.each(function(){const h=vt.getOrCreateInstance(this,a);if(typeof r=="string"){if(h[r]===void 0)throw new TypeError(`No method named "${r}"`);h[r]()}})}}k.on(document,Qo,Xs,function(c){(c.target.tagName==="A"||c.delegateTarget&&c.delegateTarget.tagName==="A")&&c.preventDefault();for(const r of j.getMultipleElementsFromSelector(this))vt.getOrCreateInstance(r,{toggle:!1}).toggle()}),P(vt);var he="top",me="bottom",_e="right",de="left",gs="auto",yt=[he,me,_e,de],Ye="start",bt="end",ci="clippingParents",Qs="viewport",wt="popper",ui="reference",Zs=yt.reduce(function(c,r){return c.concat([r+"-"+Ye,r+"-"+bt])},[]),er=[].concat(yt,[gs]).reduce(function(c,r){return c.concat([r,r+"-"+Ye,r+"-"+bt])},[]),hi="beforeRead",di="read",fi="afterRead",pi="beforeMain",gi="main",mi="afterMain",_i="beforeWrite",vi="write",yi="afterWrite",bi=[hi,di,fi,pi,gi,mi,_i,vi,yi];function je(c){return c?(c.nodeName||"").toLowerCase():null}function ve(c){if(c==null)return window;if(c.toString()!=="[object Window]"){var r=c.ownerDocument;return r&&r.defaultView||window}return c}function Xe(c){return c instanceof ve(c).Element||c instanceof Element}function Ee(c){return c instanceof ve(c).HTMLElement||c instanceof HTMLElement}function tr(c){return typeof ShadowRoot<"u"&&(c instanceof ve(c).ShadowRoot||c instanceof ShadowRoot)}const sr={name:"applyStyles",enabled:!0,phase:"write",fn:function(c){var r=c.state;Object.keys(r.elements).forEach(function(a){var h=r.styles[a]||{},p=r.attributes[a]||{},m=r.elements[a];Ee(m)&&je(m)&&(Object.assign(m.style,h),Object.keys(p).forEach(function(v){var E=p[v];E===!1?m.removeAttribute(v):m.setAttribute(v,E===!0?"":E)}))})},effect:function(c){var r=c.state,a={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,a.popper),r.styles=a,r.elements.arrow&&Object.assign(r.elements.arrow.style,a.arrow),function(){Object.keys(r.elements).forEach(function(h){var p=r.elements[h],m=r.attributes[h]||{},v=Object.keys(r.styles.hasOwnProperty(h)?r.styles[h]:a[h]).reduce(function(E,A){return E[A]="",E},{});Ee(p)&&je(p)&&(Object.assign(p.style,v),Object.keys(m).forEach(function(E){p.removeAttribute(E)}))})}},requires:["computeStyles"]};function Le(c){return c.split("-")[0]}var Qe=Math.max,ms=Math.min,Et=Math.round;function rr(){var c=navigator.userAgentData;return c!=null&&c.brands&&Array.isArray(c.brands)?c.brands.map(function(r){return r.brand+"/"+r.version}).join(" "):navigator.userAgent}function wi(){return!/^((?!chrome|android).)*safari/i.test(rr())}function kt(c,r,a){r===void 0&&(r=!1),a===void 0&&(a=!1);var h=c.getBoundingClientRect(),p=1,m=1;r&&Ee(c)&&(p=c.offsetWidth>0&&Et(h.width)/c.offsetWidth||1,m=c.offsetHeight>0&&Et(h.height)/c.offsetHeight||1);var v=(Xe(c)?ve(c):window).visualViewport,E=!wi()&&a,A=(h.left+(E&&v?v.offsetLeft:0))/p,I=(h.top+(E&&v?v.offsetTop:0))/m,x=h.width/p,R=h.height/m;return{width:x,height:R,top:I,right:A+x,bottom:I+R,left:A,x:A,y:I}}function ir(c){var r=kt(c),a=c.offsetWidth,h=c.offsetHeight;return Math.abs(r.width-a)<=1&&(a=r.width),Math.abs(r.height-h)<=1&&(h=r.height),{x:c.offsetLeft,y:c.offsetTop,width:a,height:h}}function Ei(c,r){var a=r.getRootNode&&r.getRootNode();if(c.contains(r))return!0;if(a&&tr(a)){var h=r;do{if(h&&c.isSameNode(h))return!0;h=h.parentNode||h.host}while(h)}return!1}function Be(c){return ve(c).getComputedStyle(c)}function sa(c){return["table","td","th"].indexOf(je(c))>=0}function Ke(c){return((Xe(c)?c.ownerDocument:c.document)||window.document).documentElement}function _s(c){return je(c)==="html"?c:c.assignedSlot||c.parentNode||(tr(c)?c.host:null)||Ke(c)}function ki(c){return Ee(c)&&Be(c).position!=="fixed"?c.offsetParent:null}function Vt(c){for(var r=ve(c),a=ki(c);a&&sa(a)&&Be(a).position==="static";)a=ki(a);return a&&(je(a)==="html"||je(a)==="body"&&Be(a).position==="static")?r:a||function(h){var p=/firefox/i.test(rr());if(/Trident/i.test(rr())&&Ee(h)&&Be(h).position==="fixed")return null;var m=_s(h);for(tr(m)&&(m=m.host);Ee(m)&&["html","body"].indexOf(je(m))<0;){var v=Be(m);if(v.transform!=="none"||v.perspective!=="none"||v.contain==="paint"||["transform","perspective"].indexOf(v.willChange)!==-1||p&&v.willChange==="filter"||p&&v.filter&&v.filter!=="none")return m;m=m.parentNode}return null}(c)||r}function nr(c){return["top","bottom"].indexOf(c)>=0?"x":"y"}function zt(c,r,a){return Qe(c,ms(r,a))}function Si(c){return Object.assign({},{top:0,right:0,bottom:0,left:0},c)}function Ti(c,r){return r.reduce(function(a,h){return a[h]=c,a},{})}const Ai={name:"arrow",enabled:!0,phase:"main",fn:function(c){var r,a=c.state,h=c.name,p=c.options,m=a.elements.arrow,v=a.modifiersData.popperOffsets,E=Le(a.placement),A=nr(E),I=[de,_e].indexOf(E)>=0?"height":"width";if(m&&v){var x=function(X,G){return Si(typeof(X=typeof X=="function"?X(Object.assign({},G.rects,{placement:G.placement})):X)!="number"?X:Ti(X,yt))}(p.padding,a),R=ir(m),F=A==="y"?he:de,D=A==="y"?me:_e,B=a.rects.reference[I]+a.rects.reference[A]-v[A]-a.rects.popper[I],U=v[A]-a.rects.reference[A],M=Vt(m),Y=M?A==="y"?M.clientHeight||0:M.clientWidth||0:0,Z=B/2-U/2,H=x[F],V=Y-R[I]-x[D],W=Y/2-R[I]/2+Z,K=zt(H,W,V),z=A;a.modifiersData[h]=((r={})[z]=K,r.centerOffset=K-W,r)}},effect:function(c){var r=c.state,a=c.options.element,h=a===void 0?"[data-popper-arrow]":a;h!=null&&(typeof h!="string"||(h=r.elements.popper.querySelector(h)))&&Ei(r.elements.popper,h)&&(r.elements.arrow=h)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function St(c){return c.split("-")[1]}var ra={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Oi(c){var r,a=c.popper,h=c.popperRect,p=c.placement,m=c.variation,v=c.offsets,E=c.position,A=c.gpuAcceleration,I=c.adaptive,x=c.roundOffsets,R=c.isFixed,F=v.x,D=F===void 0?0:F,B=v.y,U=B===void 0?0:B,M=typeof x=="function"?x({x:D,y:U}):{x:D,y:U};D=M.x,U=M.y;var Y=v.hasOwnProperty("x"),Z=v.hasOwnProperty("y"),H=de,V=he,W=window;if(I){var K=Vt(a),z="clientHeight",X="clientWidth";K===ve(a)&&Be(K=Ke(a)).position!=="static"&&E==="absolute"&&(z="scrollHeight",X="scrollWidth"),(p===he||(p===de||p===_e)&&m===bt)&&(V=me,U-=(R&&K===W&&W.visualViewport?W.visualViewport.height:K[z])-h.height,U*=A?1:-1),p!==de&&(p!==he&&p!==me||m!==bt)||(H=_e,D-=(R&&K===W&&W.visualViewport?W.visualViewport.width:K[X])-h.width,D*=A?1:-1)}var G,ne=Object.assign({position:E},I&&ra),ye=x===!0?function(Re,fe){var Se=Re.x,Te=Re.y,te=fe.devicePixelRatio||1;return{x:Et(Se*te)/te||0,y:Et(Te*te)/te||0}}({x:D,y:U},ve(a)):{x:D,y:U};return D=ye.x,U=ye.y,A?Object.assign({},ne,((G={})[V]=Z?"0":"",G[H]=Y?"0":"",G.transform=(W.devicePixelRatio||1)<=1?"translate("+D+"px, "+U+"px)":"translate3d("+D+"px, "+U+"px, 0)",G)):Object.assign({},ne,((r={})[V]=Z?U+"px":"",r[H]=Y?D+"px":"",r.transform="",r))}const or={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(c){var r=c.state,a=c.options,h=a.gpuAcceleration,p=h===void 0||h,m=a.adaptive,v=m===void 0||m,E=a.roundOffsets,A=E===void 0||E,I={placement:Le(r.placement),variation:St(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:p,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,Oi(Object.assign({},I,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:v,roundOffsets:A})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,Oi(Object.assign({},I,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:A})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})},data:{}};var vs={passive:!0};const ar={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(c){var r=c.state,a=c.instance,h=c.options,p=h.scroll,m=p===void 0||p,v=h.resize,E=v===void 0||v,A=ve(r.elements.popper),I=[].concat(r.scrollParents.reference,r.scrollParents.popper);return m&&I.forEach(function(x){x.addEventListener("scroll",a.update,vs)}),E&&A.addEventListener("resize",a.update,vs),function(){m&&I.forEach(function(x){x.removeEventListener("scroll",a.update,vs)}),E&&A.removeEventListener("resize",a.update,vs)}},data:{}};var ia={left:"right",right:"left",bottom:"top",top:"bottom"};function ys(c){return c.replace(/left|right|bottom|top/g,function(r){return ia[r]})}var na={start:"end",end:"start"};function Ci(c){return c.replace(/start|end/g,function(r){return na[r]})}function lr(c){var r=ve(c);return{scrollLeft:r.pageXOffset,scrollTop:r.pageYOffset}}function cr(c){return kt(Ke(c)).left+lr(c).scrollLeft}function ur(c){var r=Be(c),a=r.overflow,h=r.overflowX,p=r.overflowY;return/auto|scroll|overlay|hidden/.test(a+p+h)}function Ri(c){return["html","body","#document"].indexOf(je(c))>=0?c.ownerDocument.body:Ee(c)&&ur(c)?c:Ri(_s(c))}function Gt(c,r){var a;r===void 0&&(r=[]);var h=Ri(c),p=h===((a=c.ownerDocument)==null?void 0:a.body),m=ve(h),v=p?[m].concat(m.visualViewport||[],ur(h)?h:[]):h,E=r.concat(v);return p?E:E.concat(Gt(_s(v)))}function hr(c){return Object.assign({},c,{left:c.x,top:c.y,right:c.x+c.width,bottom:c.y+c.height})}function Pi(c,r,a){return r===Qs?hr(function(h,p){var m=ve(h),v=Ke(h),E=m.visualViewport,A=v.clientWidth,I=v.clientHeight,x=0,R=0;if(E){A=E.width,I=E.height;var F=wi();(F||!F&&p==="fixed")&&(x=E.offsetLeft,R=E.offsetTop)}return{width:A,height:I,x:x+cr(h),y:R}}(c,a)):Xe(r)?function(h,p){var m=kt(h,!1,p==="fixed");return m.top=m.top+h.clientTop,m.left=m.left+h.clientLeft,m.bottom=m.top+h.clientHeight,m.right=m.left+h.clientWidth,m.width=h.clientWidth,m.height=h.clientHeight,m.x=m.left,m.y=m.top,m}(r,a):hr(function(h){var p,m=Ke(h),v=lr(h),E=(p=h.ownerDocument)==null?void 0:p.body,A=Qe(m.scrollWidth,m.clientWidth,E?E.scrollWidth:0,E?E.clientWidth:0),I=Qe(m.scrollHeight,m.clientHeight,E?E.scrollHeight:0,E?E.clientHeight:0),x=-v.scrollLeft+cr(h),R=-v.scrollTop;return Be(E||m).direction==="rtl"&&(x+=Qe(m.clientWidth,E?E.clientWidth:0)-A),{width:A,height:I,x,y:R}}(Ke(c)))}function Ii(c){var r,a=c.reference,h=c.element,p=c.placement,m=p?Le(p):null,v=p?St(p):null,E=a.x+a.width/2-h.width/2,A=a.y+a.height/2-h.height/2;switch(m){case he:r={x:E,y:a.y-h.height};break;case me:r={x:E,y:a.y+a.height};break;case _e:r={x:a.x+a.width,y:A};break;case de:r={x:a.x-h.width,y:A};break;default:r={x:a.x,y:a.y}}var I=m?nr(m):null;if(I!=null){var x=I==="y"?"height":"width";switch(v){case Ye:r[I]=r[I]-(a[x]/2-h[x]/2);break;case bt:r[I]=r[I]+(a[x]/2-h[x]/2)}}return r}function Tt(c,r){r===void 0&&(r={});var a=r,h=a.placement,p=h===void 0?c.placement:h,m=a.strategy,v=m===void 0?c.strategy:m,E=a.boundary,A=E===void 0?ci:E,I=a.rootBoundary,x=I===void 0?Qs:I,R=a.elementContext,F=R===void 0?wt:R,D=a.altBoundary,B=D!==void 0&&D,U=a.padding,M=U===void 0?0:U,Y=Si(typeof M!="number"?M:Ti(M,yt)),Z=F===wt?ui:wt,H=c.rects.popper,V=c.elements[B?Z:F],W=function(fe,Se,Te,te){var Ne=Se==="clippingParents"?function(Q){var pe=Gt(_s(Q)),Ae=["absolute","fixed"].indexOf(Be(Q).position)>=0&&Ee(Q)?Vt(Q):Q;return Xe(Ae)?pe.filter(function(ze){return Xe(ze)&&Ei(ze,Ae)&&je(ze)!=="body"}):[]}(fe):[].concat(Se),De=[].concat(Ne,[Te]),Ct=De[0],le=De.reduce(function(Q,pe){var Ae=Pi(fe,pe,te);return Q.top=Qe(Ae.top,Q.top),Q.right=ms(Ae.right,Q.right),Q.bottom=ms(Ae.bottom,Q.bottom),Q.left=Qe(Ae.left,Q.left),Q},Pi(fe,Ct,te));return le.width=le.right-le.left,le.height=le.bottom-le.top,le.x=le.left,le.y=le.top,le}(Xe(V)?V:V.contextElement||Ke(c.elements.popper),A,x,v),K=kt(c.elements.reference),z=Ii({reference:K,element:H,placement:p}),X=hr(Object.assign({},H,z)),G=F===wt?X:K,ne={top:W.top-G.top+Y.top,bottom:G.bottom-W.bottom+Y.bottom,left:W.left-G.left+Y.left,right:G.right-W.right+Y.right},ye=c.modifiersData.offset;if(F===wt&&ye){var Re=ye[p];Object.keys(ne).forEach(function(fe){var Se=[_e,me].indexOf(fe)>=0?1:-1,Te=[he,me].indexOf(fe)>=0?"y":"x";ne[fe]+=Re[Te]*Se})}return ne}function oa(c,r){r===void 0&&(r={});var a=r,h=a.placement,p=a.boundary,m=a.rootBoundary,v=a.padding,E=a.flipVariations,A=a.allowedAutoPlacements,I=A===void 0?er:A,x=St(h),R=x?E?Zs:Zs.filter(function(B){return St(B)===x}):yt,F=R.filter(function(B){return I.indexOf(B)>=0});F.length===0&&(F=R);var D=F.reduce(function(B,U){return B[U]=Tt(c,{placement:U,boundary:p,rootBoundary:m,padding:v})[Le(U)],B},{});return Object.keys(D).sort(function(B,U){return D[B]-D[U]})}const xi={name:"flip",enabled:!0,phase:"main",fn:function(c){var r=c.state,a=c.options,h=c.name;if(!r.modifiersData[h]._skip){for(var p=a.mainAxis,m=p===void 0||p,v=a.altAxis,E=v===void 0||v,A=a.fallbackPlacements,I=a.padding,x=a.boundary,R=a.rootBoundary,F=a.altBoundary,D=a.flipVariations,B=D===void 0||D,U=a.allowedAutoPlacements,M=r.options.placement,Y=Le(M),Z=A||(Y!==M&&B?function(Q){if(Le(Q)===gs)return[];var pe=ys(Q);return[Ci(Q),pe,Ci(pe)]}(M):[ys(M)]),H=[M].concat(Z).reduce(function(Q,pe){return Q.concat(Le(pe)===gs?oa(r,{placement:pe,boundary:x,rootBoundary:R,padding:I,flipVariations:B,allowedAutoPlacements:U}):pe)},[]),V=r.rects.reference,W=r.rects.popper,K=new Map,z=!0,X=H[0],G=0;G<H.length;G++){var ne=H[G],ye=Le(ne),Re=St(ne)===Ye,fe=[he,me].indexOf(ye)>=0,Se=fe?"width":"height",Te=Tt(r,{placement:ne,boundary:x,rootBoundary:R,altBoundary:F,padding:I}),te=fe?Re?_e:de:Re?me:he;V[Se]>W[Se]&&(te=ys(te));var Ne=ys(te),De=[];if(m&&De.push(Te[ye]<=0),E&&De.push(Te[te]<=0,Te[Ne]<=0),De.every(function(Q){return Q})){X=ne,z=!1;break}K.set(ne,De)}if(z)for(var Ct=function(Q){var pe=H.find(function(Ae){var ze=K.get(Ae);if(ze)return ze.slice(0,Q).every(function(Cs){return Cs})});if(pe)return X=pe,"break"},le=B?3:1;le>0&&Ct(le)!=="break";le--);r.placement!==X&&(r.modifiersData[h]._skip=!0,r.placement=X,r.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function $i(c,r,a){return a===void 0&&(a={x:0,y:0}),{top:c.top-r.height-a.y,right:c.right-r.width+a.x,bottom:c.bottom-r.height+a.y,left:c.left-r.width-a.x}}function ji(c){return[he,_e,me,de].some(function(r){return c[r]>=0})}const Li={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(c){var r=c.state,a=c.name,h=r.rects.reference,p=r.rects.popper,m=r.modifiersData.preventOverflow,v=Tt(r,{elementContext:"reference"}),E=Tt(r,{altBoundary:!0}),A=$i(v,h),I=$i(E,p,m),x=ji(A),R=ji(I);r.modifiersData[a]={referenceClippingOffsets:A,popperEscapeOffsets:I,isReferenceHidden:x,hasPopperEscaped:R},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":x,"data-popper-escaped":R})}},Ni={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(c){var r=c.state,a=c.options,h=c.name,p=a.offset,m=p===void 0?[0,0]:p,v=er.reduce(function(x,R){return x[R]=function(F,D,B){var U=Le(F),M=[de,he].indexOf(U)>=0?-1:1,Y=typeof B=="function"?B(Object.assign({},D,{placement:F})):B,Z=Y[0],H=Y[1];return Z=Z||0,H=(H||0)*M,[de,_e].indexOf(U)>=0?{x:H,y:Z}:{x:Z,y:H}}(R,r.rects,m),x},{}),E=v[r.placement],A=E.x,I=E.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=A,r.modifiersData.popperOffsets.y+=I),r.modifiersData[h]=v}},dr={name:"popperOffsets",enabled:!0,phase:"read",fn:function(c){var r=c.state,a=c.name;r.modifiersData[a]=Ii({reference:r.rects.reference,element:r.rects.popper,placement:r.placement})},data:{}},Di={name:"preventOverflow",enabled:!0,phase:"main",fn:function(c){var r=c.state,a=c.options,h=c.name,p=a.mainAxis,m=p===void 0||p,v=a.altAxis,E=v!==void 0&&v,A=a.boundary,I=a.rootBoundary,x=a.altBoundary,R=a.padding,F=a.tether,D=F===void 0||F,B=a.tetherOffset,U=B===void 0?0:B,M=Tt(r,{boundary:A,rootBoundary:I,padding:R,altBoundary:x}),Y=Le(r.placement),Z=St(r.placement),H=!Z,V=nr(Y),W=V==="x"?"y":"x",K=r.modifiersData.popperOffsets,z=r.rects.reference,X=r.rects.popper,G=typeof U=="function"?U(Object.assign({},r.rects,{placement:r.placement})):U,ne=typeof G=="number"?{mainAxis:G,altAxis:G}:Object.assign({mainAxis:0,altAxis:0},G),ye=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,Re={x:0,y:0};if(K){if(m){var fe,Se=V==="y"?he:de,Te=V==="y"?me:_e,te=V==="y"?"height":"width",Ne=K[V],De=Ne+M[Se],Ct=Ne-M[Te],le=D?-X[te]/2:0,Q=Z===Ye?z[te]:X[te],pe=Z===Ye?-X[te]:-z[te],Ae=r.elements.arrow,ze=D&&Ae?ir(Ae):{width:0,height:0},Cs=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Sn=Cs[Se],Tn=Cs[Te],Rs=zt(0,z[te],ze[te]),Ul=H?z[te]/2-le-Rs-Sn-ne.mainAxis:Q-Rs-Sn-ne.mainAxis,Bl=H?-z[te]/2+le+Rs+Tn+ne.mainAxis:pe+Rs+Tn+ne.mainAxis,Ar=r.elements.arrow&&Vt(r.elements.arrow),Ml=Ar?V==="y"?Ar.clientTop||0:Ar.clientLeft||0:0,An=(fe=ye==null?void 0:ye[V])!=null?fe:0,ql=Ne+Bl-An,On=zt(D?ms(De,Ne+Ul-An-Ml):De,Ne,D?Qe(Ct,ql):Ct);K[V]=On,Re[V]=On-Ne}if(E){var Cn,Fl=V==="x"?he:de,Wl=V==="x"?me:_e,ot=K[W],Ps=W==="y"?"height":"width",Rn=ot+M[Fl],Pn=ot-M[Wl],Or=[he,de].indexOf(Y)!==-1,In=(Cn=ye==null?void 0:ye[W])!=null?Cn:0,xn=Or?Rn:ot-z[Ps]-X[Ps]-In+ne.altAxis,$n=Or?ot+z[Ps]+X[Ps]-In-ne.altAxis:Pn,jn=D&&Or?function(Hl,Kl,Cr){var Ln=zt(Hl,Kl,Cr);return Ln>Cr?Cr:Ln}(xn,ot,$n):zt(D?xn:Rn,ot,D?$n:Pn);K[W]=jn,Re[W]=jn-ot}r.modifiersData[h]=Re}},requiresIfExists:["offset"]};function aa(c,r,a){a===void 0&&(a=!1);var h,p,m=Ee(r),v=Ee(r)&&function(R){var F=R.getBoundingClientRect(),D=Et(F.width)/R.offsetWidth||1,B=Et(F.height)/R.offsetHeight||1;return D!==1||B!==1}(r),E=Ke(r),A=kt(c,v,a),I={scrollLeft:0,scrollTop:0},x={x:0,y:0};return(m||!m&&!a)&&((je(r)!=="body"||ur(E))&&(I=(h=r)!==ve(h)&&Ee(h)?{scrollLeft:(p=h).scrollLeft,scrollTop:p.scrollTop}:lr(h)),Ee(r)?((x=kt(r,!0)).x+=r.clientLeft,x.y+=r.clientTop):E&&(x.x=cr(E))),{x:A.left+I.scrollLeft-x.x,y:A.top+I.scrollTop-x.y,width:A.width,height:A.height}}function la(c){var r=new Map,a=new Set,h=[];function p(m){a.add(m.name),[].concat(m.requires||[],m.requiresIfExists||[]).forEach(function(v){if(!a.has(v)){var E=r.get(v);E&&p(E)}}),h.push(m)}return c.forEach(function(m){r.set(m.name,m)}),c.forEach(function(m){a.has(m.name)||p(m)}),h}var Ui={placement:"bottom",modifiers:[],strategy:"absolute"};function Bi(){for(var c=arguments.length,r=new Array(c),a=0;a<c;a++)r[a]=arguments[a];return!r.some(function(h){return!(h&&typeof h.getBoundingClientRect=="function")})}function bs(c){c===void 0&&(c={});var r=c,a=r.defaultModifiers,h=a===void 0?[]:a,p=r.defaultOptions,m=p===void 0?Ui:p;return function(v,E,A){A===void 0&&(A=m);var I,x,R={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ui,m),modifiersData:{},elements:{reference:v,popper:E},attributes:{},styles:{}},F=[],D=!1,B={state:R,setOptions:function(M){var Y=typeof M=="function"?M(R.options):M;U(),R.options=Object.assign({},m,R.options,Y),R.scrollParents={reference:Xe(v)?Gt(v):v.contextElement?Gt(v.contextElement):[],popper:Gt(E)};var Z,H,V=function(W){var K=la(W);return bi.reduce(function(z,X){return z.concat(K.filter(function(G){return G.phase===X}))},[])}((Z=[].concat(h,R.options.modifiers),H=Z.reduce(function(W,K){var z=W[K.name];return W[K.name]=z?Object.assign({},z,K,{options:Object.assign({},z.options,K.options),data:Object.assign({},z.data,K.data)}):K,W},{}),Object.keys(H).map(function(W){return H[W]})));return R.orderedModifiers=V.filter(function(W){return W.enabled}),R.orderedModifiers.forEach(function(W){var K=W.name,z=W.options,X=z===void 0?{}:z,G=W.effect;if(typeof G=="function"){var ne=G({state:R,name:K,instance:B,options:X});F.push(ne||function(){})}}),B.update()},forceUpdate:function(){if(!D){var M=R.elements,Y=M.reference,Z=M.popper;if(Bi(Y,Z)){R.rects={reference:aa(Y,Vt(Z),R.options.strategy==="fixed"),popper:ir(Z)},R.reset=!1,R.placement=R.options.placement,R.orderedModifiers.forEach(function(G){return R.modifiersData[G.name]=Object.assign({},G.data)});for(var H=0;H<R.orderedModifiers.length;H++)if(R.reset!==!0){var V=R.orderedModifiers[H],W=V.fn,K=V.options,z=K===void 0?{}:K,X=V.name;typeof W=="function"&&(R=W({state:R,options:z,name:X,instance:B})||R)}else R.reset=!1,H=-1}}},update:(I=function(){return new Promise(function(M){B.forceUpdate(),M(R)})},function(){return x||(x=new Promise(function(M){Promise.resolve().then(function(){x=void 0,M(I())})})),x}),destroy:function(){U(),D=!0}};if(!Bi(v,E))return B;function U(){F.forEach(function(M){return M()}),F=[]}return B.setOptions(A).then(function(M){!D&&A.onFirstUpdate&&A.onFirstUpdate(M)}),B}}var ca=bs(),ua=bs({defaultModifiers:[ar,dr,or,sr]}),fr=bs({defaultModifiers:[ar,dr,or,sr,Ni,xi,Di,Ai,Li]});const Mi=Object.freeze(Object.defineProperty({__proto__:null,afterMain:mi,afterRead:fi,afterWrite:yi,applyStyles:sr,arrow:Ai,auto:gs,basePlacements:yt,beforeMain:pi,beforeRead:hi,beforeWrite:_i,bottom:me,clippingParents:ci,computeStyles:or,createPopper:fr,createPopperBase:ca,createPopperLite:ua,detectOverflow:Tt,end:bt,eventListeners:ar,flip:xi,hide:Li,left:de,main:gi,modifierPhases:bi,offset:Ni,placements:er,popper:wt,popperGenerator:bs,popperOffsets:dr,preventOverflow:Di,read:di,reference:ui,right:_e,start:Ye,top:he,variationPlacements:Zs,viewport:Qs,write:vi},Symbol.toStringTag,{value:"Module"})),qi="dropdown",Ze=".bs.dropdown",pr=".data-api",ha="ArrowUp",Fi="ArrowDown",da=`hide${Ze}`,fa=`hidden${Ze}`,pa=`show${Ze}`,ga=`shown${Ze}`,Wi=`click${Ze}${pr}`,Hi=`keydown${Ze}${pr}`,ma=`keyup${Ze}${pr}`,At="show",et='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',_a=`${et}.${At}`,ws=".dropdown-menu",va=C()?"top-end":"top-start",ya=C()?"top-start":"top-end",ba=C()?"bottom-end":"bottom-start",wa=C()?"bottom-start":"bottom-end",Ea=C()?"left-start":"right-start",ka=C()?"right-start":"left-start",Sa={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Ta={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ce extends Oe{constructor(r,a){super(r,a),this._popper=null,this._parent=this._element.parentNode,this._menu=j.next(this._element,ws)[0]||j.prev(this._element,ws)[0]||j.findOne(ws,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Sa}static get DefaultType(){return Ta}static get NAME(){return qi}toggle(){return this._isShown()?this.hide():this.show()}show(){if(b(this._element)||this._isShown())return;const r={relatedTarget:this._element};if(!k.trigger(this._element,pa,r).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const a of[].concat(...document.body.children))k.on(a,"mouseover",_);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(At),this._element.classList.add(At),k.trigger(this._element,ga,r)}}hide(){if(b(this._element)||!this._isShown())return;const r={relatedTarget:this._element};this._completeHide(r)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(r){if(!k.trigger(this._element,da,r).defaultPrevented){if("ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))k.off(a,"mouseover",_);this._popper&&this._popper.destroy(),this._menu.classList.remove(At),this._element.classList.remove(At),this._element.setAttribute("aria-expanded","false"),Ue.removeDataAttribute(this._menu,"popper"),k.trigger(this._element,fa,r)}}_getConfig(r){if(typeof(r=super._getConfig(r)).reference=="object"&&!d(r.reference)&&typeof r.reference.getBoundingClientRect!="function")throw new TypeError(`${qi.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return r}_createPopper(){if(Mi===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let r=this._element;this._config.reference==="parent"?r=this._parent:d(this._config.reference)?r=f(this._config.reference):typeof this._config.reference=="object"&&(r=this._config.reference);const a=this._getPopperConfig();this._popper=fr(r,this._menu,a)}_isShown(){return this._menu.classList.contains(At)}_getPlacement(){const r=this._parent;if(r.classList.contains("dropend"))return Ea;if(r.classList.contains("dropstart"))return ka;if(r.classList.contains("dropup-center"))return"top";if(r.classList.contains("dropdown-center"))return"bottom";const a=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return r.classList.contains("dropup")?a?ya:va:a?wa:ba}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:r}=this._config;return typeof r=="string"?r.split(",").map(a=>Number.parseInt(a,10)):typeof r=="function"?a=>r(a,this._element):r}_getPopperConfig(){const r={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Ue.setDataAttribute(this._menu,"popper","static"),r.modifiers=[{name:"applyStyles",enabled:!1}]),{...r,...T(this._config.popperConfig,[void 0,r])}}_selectMenuItem({key:r,target:a}){const h=j.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(p=>g(p));h.length&&re(h,a,r===Fi,!h.includes(a)).focus()}static jQueryInterface(r){return this.each(function(){const a=Ce.getOrCreateInstance(this,r);if(typeof r=="string"){if(a[r]===void 0)throw new TypeError(`No method named "${r}"`);a[r]()}})}static clearMenus(r){if(r.button===2||r.type==="keyup"&&r.key!=="Tab")return;const a=j.find(_a);for(const h of a){const p=Ce.getInstance(h);if(!p||p._config.autoClose===!1)continue;const m=r.composedPath(),v=m.includes(p._menu);if(m.includes(p._element)||p._config.autoClose==="inside"&&!v||p._config.autoClose==="outside"&&v||p._menu.contains(r.target)&&(r.type==="keyup"&&r.key==="Tab"||/input|select|option|textarea|form/i.test(r.target.tagName)))continue;const E={relatedTarget:p._element};r.type==="click"&&(E.clickEvent=r),p._completeHide(E)}}static dataApiKeydownHandler(r){const a=/input|textarea/i.test(r.target.tagName),h=r.key==="Escape",p=[ha,Fi].includes(r.key);if(!p&&!h||a&&!h)return;r.preventDefault();const m=this.matches(et)?this:j.prev(this,et)[0]||j.next(this,et)[0]||j.findOne(et,r.delegateTarget.parentNode),v=Ce.getOrCreateInstance(m);if(p)return r.stopPropagation(),v.show(),void v._selectMenuItem(r);v._isShown()&&(r.stopPropagation(),v.hide(),m.focus())}}k.on(document,Hi,et,Ce.dataApiKeydownHandler),k.on(document,Hi,ws,Ce.dataApiKeydownHandler),k.on(document,Wi,Ce.clearMenus),k.on(document,ma,Ce.clearMenus),k.on(document,Wi,et,function(c){c.preventDefault(),Ce.getOrCreateInstance(this).toggle()}),P(Ce);const Ki="backdrop",Vi="show",zi=`mousedown.bs.${Ki}`,Aa={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Oa={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Gi extends qt{constructor(r){super(),this._config=this._getConfig(r),this._isAppended=!1,this._element=null}static get Default(){return Aa}static get DefaultType(){return Oa}static get NAME(){return Ki}show(r){if(!this._config.isVisible)return void T(r);this._append();const a=this._getElement();this._config.isAnimated&&w(a),a.classList.add(Vi),this._emulateAnimation(()=>{T(r)})}hide(r){this._config.isVisible?(this._getElement().classList.remove(Vi),this._emulateAnimation(()=>{this.dispose(),T(r)})):T(r)}dispose(){this._isAppended&&(k.off(this._element,zi),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const r=document.createElement("div");r.className=this._config.className,this._config.isAnimated&&r.classList.add("fade"),this._element=r}return this._element}_configAfterMerge(r){return r.rootElement=f(r.rootElement),r}_append(){if(this._isAppended)return;const r=this._getElement();this._config.rootElement.append(r),k.on(r,zi,()=>{T(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(r){q(r,this._getElement(),this._config.isAnimated)}}const Es=".bs.focustrap",Ca=`focusin${Es}`,Ra=`keydown.tab${Es}`,Ji="backward",Pa={autofocus:!0,trapElement:null},Ia={autofocus:"boolean",trapElement:"element"};class Yi extends qt{constructor(r){super(),this._config=this._getConfig(r),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Pa}static get DefaultType(){return Ia}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),k.off(document,Es),k.on(document,Ca,r=>this._handleFocusin(r)),k.on(document,Ra,r=>this._handleKeydown(r)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,k.off(document,Es))}_handleFocusin(r){const{trapElement:a}=this._config;if(r.target===document||r.target===a||a.contains(r.target))return;const h=j.focusableChildren(a);h.length===0?a.focus():this._lastTabNavDirection===Ji?h[h.length-1].focus():h[0].focus()}_handleKeydown(r){r.key==="Tab"&&(this._lastTabNavDirection=r.shiftKey?Ji:"forward")}}const Xi=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Qi=".sticky-top",ks="padding-right",Zi="margin-right";class gr{constructor(){this._element=document.body}getWidth(){const r=document.documentElement.clientWidth;return Math.abs(window.innerWidth-r)}hide(){const r=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,ks,a=>a+r),this._setElementAttributes(Xi,ks,a=>a+r),this._setElementAttributes(Qi,Zi,a=>a-r)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,ks),this._resetElementAttributes(Xi,ks),this._resetElementAttributes(Qi,Zi)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(r,a,h){const p=this.getWidth();this._applyManipulationCallback(r,m=>{if(m!==this._element&&window.innerWidth>m.clientWidth+p)return;this._saveInitialAttribute(m,a);const v=window.getComputedStyle(m).getPropertyValue(a);m.style.setProperty(a,`${h(Number.parseFloat(v))}px`)})}_saveInitialAttribute(r,a){const h=r.style.getPropertyValue(a);h&&Ue.setDataAttribute(r,a,h)}_resetElementAttributes(r,a){this._applyManipulationCallback(r,h=>{const p=Ue.getDataAttribute(h,a);p!==null?(Ue.removeDataAttribute(h,a),h.style.setProperty(a,p)):h.style.removeProperty(a)})}_applyManipulationCallback(r,a){if(d(r))a(r);else for(const h of j.find(r,this._element))a(h)}}const ke=".bs.modal",xa=`hide${ke}`,$a=`hidePrevented${ke}`,en=`hidden${ke}`,tn=`show${ke}`,ja=`shown${ke}`,La=`resize${ke}`,Na=`click.dismiss${ke}`,Da=`mousedown.dismiss${ke}`,Ua=`keydown.dismiss${ke}`,Ba=`click${ke}.data-api`,sn="modal-open",rn="show",mr="modal-static",Ma={backdrop:!0,focus:!0,keyboard:!0},qa={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class tt extends Oe{constructor(r,a){super(r,a),this._dialog=j.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new gr,this._addEventListeners()}static get Default(){return Ma}static get DefaultType(){return qa}static get NAME(){return"modal"}toggle(r){return this._isShown?this.hide():this.show(r)}show(r){this._isShown||this._isTransitioning||k.trigger(this._element,tn,{relatedTarget:r}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(sn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(r)))}hide(){this._isShown&&!this._isTransitioning&&(k.trigger(this._element,xa).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(rn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){k.off(window,ke),k.off(this._dialog,ke),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Gi({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Yi({trapElement:this._element})}_showElement(r){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const a=j.findOne(".modal-body",this._dialog);a&&(a.scrollTop=0),w(this._element),this._element.classList.add(rn),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,k.trigger(this._element,ja,{relatedTarget:r})},this._dialog,this._isAnimated())}_addEventListeners(){k.on(this._element,Ua,r=>{r.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),k.on(window,La,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),k.on(this._element,Da,r=>{k.one(this._element,Na,a=>{this._element===r.target&&this._element===a.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(sn),this._resetAdjustments(),this._scrollBar.reset(),k.trigger(this._element,en)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(k.trigger(this._element,$a).defaultPrevented)return;const r=this._element.scrollHeight>document.documentElement.clientHeight,a=this._element.style.overflowY;a==="hidden"||this._element.classList.contains(mr)||(r||(this._element.style.overflowY="hidden"),this._element.classList.add(mr),this._queueCallback(()=>{this._element.classList.remove(mr),this._queueCallback(()=>{this._element.style.overflowY=a},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const r=this._element.scrollHeight>document.documentElement.clientHeight,a=this._scrollBar.getWidth(),h=a>0;if(h&&!r){const p=C()?"paddingLeft":"paddingRight";this._element.style[p]=`${a}px`}if(!h&&r){const p=C()?"paddingRight":"paddingLeft";this._element.style[p]=`${a}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(r,a){return this.each(function(){const h=tt.getOrCreateInstance(this,r);if(typeof r=="string"){if(h[r]===void 0)throw new TypeError(`No method named "${r}"`);h[r](a)}})}}k.on(document,Ba,'[data-bs-toggle="modal"]',function(c){const r=j.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&c.preventDefault(),k.one(r,tn,h=>{h.defaultPrevented||k.one(r,en,()=>{g(this)&&this.focus()})});const a=j.findOne(".modal.show");a&&tt.getInstance(a).hide(),tt.getOrCreateInstance(r).toggle(this)}),us(tt),P(tt);const Me=".bs.offcanvas",nn=".data-api",Fa=`load${Me}${nn}`,on="show",an="showing",ln="hiding",cn=".offcanvas.show",Wa=`show${Me}`,Ha=`shown${Me}`,Ka=`hide${Me}`,un=`hidePrevented${Me}`,hn=`hidden${Me}`,Va=`resize${Me}`,za=`click${Me}${nn}`,Ga=`keydown.dismiss${Me}`,Ja={backdrop:!0,keyboard:!0,scroll:!1},Ya={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class qe extends Oe{constructor(r,a){super(r,a),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Ja}static get DefaultType(){return Ya}static get NAME(){return"offcanvas"}toggle(r){return this._isShown?this.hide():this.show(r)}show(r){this._isShown||k.trigger(this._element,Wa,{relatedTarget:r}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new gr().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(an),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(on),this._element.classList.remove(an),k.trigger(this._element,Ha,{relatedTarget:r})},this._element,!0))}hide(){this._isShown&&(k.trigger(this._element,Ka).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(ln),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(on,ln),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new gr().reset(),k.trigger(this._element,hn)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const r=!!this._config.backdrop;return new Gi({className:"offcanvas-backdrop",isVisible:r,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:r?()=>{this._config.backdrop!=="static"?this.hide():k.trigger(this._element,un)}:null})}_initializeFocusTrap(){return new Yi({trapElement:this._element})}_addEventListeners(){k.on(this._element,Ga,r=>{r.key==="Escape"&&(this._config.keyboard?this.hide():k.trigger(this._element,un))})}static jQueryInterface(r){return this.each(function(){const a=qe.getOrCreateInstance(this,r);if(typeof r=="string"){if(a[r]===void 0||r.startsWith("_")||r==="constructor")throw new TypeError(`No method named "${r}"`);a[r](this)}})}}k.on(document,za,'[data-bs-toggle="offcanvas"]',function(c){const r=j.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&c.preventDefault(),b(this))return;k.one(r,hn,()=>{g(this)&&this.focus()});const a=j.findOne(cn);a&&a!==r&&qe.getInstance(a).hide(),qe.getOrCreateInstance(r).toggle(this)}),k.on(window,Fa,()=>{for(const c of j.find(cn))qe.getOrCreateInstance(c).show()}),k.on(window,Va,()=>{for(const c of j.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(c).position!=="fixed"&&qe.getOrCreateInstance(c).hide()}),us(qe),P(qe);const dn={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Xa=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Qa=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Za=(c,r)=>{const a=c.nodeName.toLowerCase();return r.includes(a)?!Xa.has(a)||!!Qa.test(c.nodeValue):r.filter(h=>h instanceof RegExp).some(h=>h.test(a))},el={allowList:dn,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},tl={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},sl={entry:"(string|element|function|null)",selector:"(string|element)"};class rl extends qt{constructor(r){super(),this._config=this._getConfig(r)}static get Default(){return el}static get DefaultType(){return tl}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(r=>this._resolvePossibleFunction(r)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(r){return this._checkContent(r),this._config.content={...this._config.content,...r},this}toHtml(){const r=document.createElement("div");r.innerHTML=this._maybeSanitize(this._config.template);for(const[p,m]of Object.entries(this._config.content))this._setContent(r,m,p);const a=r.children[0],h=this._resolvePossibleFunction(this._config.extraClass);return h&&a.classList.add(...h.split(" ")),a}_typeCheckConfig(r){super._typeCheckConfig(r),this._checkContent(r.content)}_checkContent(r){for(const[a,h]of Object.entries(r))super._typeCheckConfig({selector:a,entry:h},sl)}_setContent(r,a,h){const p=j.findOne(h,r);p&&((a=this._resolvePossibleFunction(a))?d(a)?this._putElementInTemplate(f(a),p):this._config.html?p.innerHTML=this._maybeSanitize(a):p.textContent=a:p.remove())}_maybeSanitize(r){return this._config.sanitize?function(a,h,p){if(!a.length)return a;if(p&&typeof p=="function")return p(a);const m=new window.DOMParser().parseFromString(a,"text/html"),v=[].concat(...m.body.querySelectorAll("*"));for(const E of v){const A=E.nodeName.toLowerCase();if(!Object.keys(h).includes(A)){E.remove();continue}const I=[].concat(...E.attributes),x=[].concat(h["*"]||[],h[A]||[]);for(const R of I)Za(R,x)||E.removeAttribute(R.nodeName)}return m.body.innerHTML}(r,this._config.allowList,this._config.sanitizeFn):r}_resolvePossibleFunction(r){return T(r,[void 0,this])}_putElementInTemplate(r,a){if(this._config.html)return a.innerHTML="",void a.append(r);a.textContent=r.textContent}}const il=new Set(["sanitize","allowList","sanitizeFn"]),_r="fade",Ss="show",nl=".tooltip-inner",fn=".modal",pn="hide.bs.modal",Jt="hover",vr="focus",yr="click",ol={AUTO:"auto",TOP:"top",RIGHT:C()?"left":"right",BOTTOM:"bottom",LEFT:C()?"right":"left"},al={allowList:dn,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},ll={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class st extends Oe{constructor(r,a){if(Mi===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(r,a),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return al}static get DefaultType(){return ll}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),k.off(this._element.closest(fn),pn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const r=k.trigger(this._element,this.constructor.eventName("show")),a=(y(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(r.defaultPrevented||!a)return;this._disposePopper();const h=this._getTipElement();this._element.setAttribute("aria-describedby",h.getAttribute("id"));const{container:p}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(p.append(h),k.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(h),h.classList.add(Ss),"ontouchstart"in document.documentElement)for(const m of[].concat(...document.body.children))k.on(m,"mouseover",_);this._queueCallback(()=>{k.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!k.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(Ss),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))k.off(r,"mouseover",_);this._activeTrigger[yr]=!1,this._activeTrigger[vr]=!1,this._activeTrigger[Jt]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),k.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(r){const a=this._getTemplateFactory(r).toHtml();if(!a)return null;a.classList.remove(_r,Ss),a.classList.add(`bs-${this.constructor.NAME}-auto`);const h=(p=>{do p+=Math.floor(1e6*Math.random());while(document.getElementById(p));return p})(this.constructor.NAME).toString();return a.setAttribute("id",h),this._isAnimated()&&a.classList.add(_r),a}setContent(r){this._newContent=r,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(r){return this._templateFactory?this._templateFactory.changeContent(r):this._templateFactory=new rl({...this._config,content:r,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[nl]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(r){return this.constructor.getOrCreateInstance(r.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(_r)}_isShown(){return this.tip&&this.tip.classList.contains(Ss)}_createPopper(r){const a=T(this._config.placement,[this,r,this._element]),h=ol[a.toUpperCase()];return fr(this._element,r,this._getPopperConfig(h))}_getOffset(){const{offset:r}=this._config;return typeof r=="string"?r.split(",").map(a=>Number.parseInt(a,10)):typeof r=="function"?a=>r(a,this._element):r}_resolvePossibleFunction(r){return T(r,[this._element,this._element])}_getPopperConfig(r){const a={placement:r,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:h=>{this._getTipElement().setAttribute("data-popper-placement",h.state.placement)}}]};return{...a,...T(this._config.popperConfig,[void 0,a])}}_setListeners(){const r=this._config.trigger.split(" ");for(const a of r)if(a==="click")k.on(this._element,this.constructor.eventName("click"),this._config.selector,h=>{const p=this._initializeOnDelegatedTarget(h);p._activeTrigger[yr]=!(p._isShown()&&p._activeTrigger[yr]),p.toggle()});else if(a!=="manual"){const h=a===Jt?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),p=a===Jt?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");k.on(this._element,h,this._config.selector,m=>{const v=this._initializeOnDelegatedTarget(m);v._activeTrigger[m.type==="focusin"?vr:Jt]=!0,v._enter()}),k.on(this._element,p,this._config.selector,m=>{const v=this._initializeOnDelegatedTarget(m);v._activeTrigger[m.type==="focusout"?vr:Jt]=v._element.contains(m.relatedTarget),v._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},k.on(this._element.closest(fn),pn,this._hideModalHandler)}_fixTitle(){const r=this._element.getAttribute("title");r&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",r),this._element.setAttribute("data-bs-original-title",r),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(r,a){clearTimeout(this._timeout),this._timeout=setTimeout(r,a)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(r){const a=Ue.getDataAttributes(this._element);for(const h of Object.keys(a))il.has(h)&&delete a[h];return r={...a,...typeof r=="object"&&r?r:{}},r=this._mergeConfigObj(r),r=this._configAfterMerge(r),this._typeCheckConfig(r),r}_configAfterMerge(r){return r.container=r.container===!1?document.body:f(r.container),typeof r.delay=="number"&&(r.delay={show:r.delay,hide:r.delay}),typeof r.title=="number"&&(r.title=r.title.toString()),typeof r.content=="number"&&(r.content=r.content.toString()),r}_getDelegateConfig(){const r={};for(const[a,h]of Object.entries(this._config))this.constructor.Default[a]!==h&&(r[a]=h);return r.selector=!1,r.trigger="manual",r}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(r){return this.each(function(){const a=st.getOrCreateInstance(this,r);if(typeof r=="string"){if(a[r]===void 0)throw new TypeError(`No method named "${r}"`);a[r]()}})}}P(st);const cl=".popover-header",ul=".popover-body",hl={...st.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},dl={...st.DefaultType,content:"(null|string|element|function)"};class Ts extends st{static get Default(){return hl}static get DefaultType(){return dl}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[cl]:this._getTitle(),[ul]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(r){return this.each(function(){const a=Ts.getOrCreateInstance(this,r);if(typeof r=="string"){if(a[r]===void 0)throw new TypeError(`No method named "${r}"`);a[r]()}})}}P(Ts);const br=".bs.scrollspy",fl=`activate${br}`,gn=`click${br}`,pl=`load${br}.data-api`,Ot="active",wr="[href]",mn=".nav-link",gl=`${mn}, .nav-item > ${mn}, .list-group-item`,ml={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},_l={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Yt extends Oe{constructor(r,a){super(r,a),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ml}static get DefaultType(){return _l}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const r of this._observableSections.values())this._observer.observe(r)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(r){return r.target=f(r.target)||document.body,r.rootMargin=r.offset?`${r.offset}px 0px -30%`:r.rootMargin,typeof r.threshold=="string"&&(r.threshold=r.threshold.split(",").map(a=>Number.parseFloat(a))),r}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(k.off(this._config.target,gn),k.on(this._config.target,gn,wr,r=>{const a=this._observableSections.get(r.target.hash);if(a){r.preventDefault();const h=this._rootElement||window,p=a.offsetTop-this._element.offsetTop;if(h.scrollTo)return void h.scrollTo({top:p,behavior:"smooth"});h.scrollTop=p}}))}_getNewObserver(){const r={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(a=>this._observerCallback(a),r)}_observerCallback(r){const a=v=>this._targetLinks.get(`#${v.target.id}`),h=v=>{this._previousScrollData.visibleEntryTop=v.target.offsetTop,this._process(a(v))},p=(this._rootElement||document.documentElement).scrollTop,m=p>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=p;for(const v of r){if(!v.isIntersecting){this._activeTarget=null,this._clearActiveClass(a(v));continue}const E=v.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(m&&E){if(h(v),!p)return}else m||E||h(v)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const r=j.find(wr,this._config.target);for(const a of r){if(!a.hash||b(a))continue;const h=j.findOne(decodeURI(a.hash),this._element);g(h)&&(this._targetLinks.set(decodeURI(a.hash),a),this._observableSections.set(a.hash,h))}}_process(r){this._activeTarget!==r&&(this._clearActiveClass(this._config.target),this._activeTarget=r,r.classList.add(Ot),this._activateParents(r),k.trigger(this._element,fl,{relatedTarget:r}))}_activateParents(r){if(r.classList.contains("dropdown-item"))j.findOne(".dropdown-toggle",r.closest(".dropdown")).classList.add(Ot);else for(const a of j.parents(r,".nav, .list-group"))for(const h of j.prev(a,gl))h.classList.add(Ot)}_clearActiveClass(r){r.classList.remove(Ot);const a=j.find(`${wr}.${Ot}`,r);for(const h of a)h.classList.remove(Ot)}static jQueryInterface(r){return this.each(function(){const a=Yt.getOrCreateInstance(this,r);if(typeof r=="string"){if(a[r]===void 0||r.startsWith("_")||r==="constructor")throw new TypeError(`No method named "${r}"`);a[r]()}})}}k.on(window,pl,()=>{for(const c of j.find('[data-bs-spy="scroll"]'))Yt.getOrCreateInstance(c)}),P(Yt);const rt=".bs.tab",vl=`hide${rt}`,yl=`hidden${rt}`,bl=`show${rt}`,wl=`shown${rt}`,El=`click${rt}`,kl=`keydown${rt}`,Sl=`load${rt}`,Tl="ArrowLeft",_n="ArrowRight",Al="ArrowUp",vn="ArrowDown",Er="Home",yn="End",it="active",bn="fade",kr="show",wn=".dropdown-toggle",Sr=`:not(${wn})`,En='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Tr=`.nav-link${Sr}, .list-group-item${Sr}, [role="tab"]${Sr}, ${En}`,Ol=`.${it}[data-bs-toggle="tab"], .${it}[data-bs-toggle="pill"], .${it}[data-bs-toggle="list"]`;class nt extends Oe{constructor(r){super(r),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),k.on(this._element,kl,a=>this._keydown(a)))}static get NAME(){return"tab"}show(){const r=this._element;if(this._elemIsActive(r))return;const a=this._getActiveElem(),h=a?k.trigger(a,vl,{relatedTarget:r}):null;k.trigger(r,bl,{relatedTarget:a}).defaultPrevented||h&&h.defaultPrevented||(this._deactivate(a,r),this._activate(r,a))}_activate(r,a){r&&(r.classList.add(it),this._activate(j.getElementFromSelector(r)),this._queueCallback(()=>{r.getAttribute("role")==="tab"?(r.removeAttribute("tabindex"),r.setAttribute("aria-selected",!0),this._toggleDropDown(r,!0),k.trigger(r,wl,{relatedTarget:a})):r.classList.add(kr)},r,r.classList.contains(bn)))}_deactivate(r,a){r&&(r.classList.remove(it),r.blur(),this._deactivate(j.getElementFromSelector(r)),this._queueCallback(()=>{r.getAttribute("role")==="tab"?(r.setAttribute("aria-selected",!1),r.setAttribute("tabindex","-1"),this._toggleDropDown(r,!1),k.trigger(r,yl,{relatedTarget:a})):r.classList.remove(kr)},r,r.classList.contains(bn)))}_keydown(r){if(![Tl,_n,Al,vn,Er,yn].includes(r.key))return;r.stopPropagation(),r.preventDefault();const a=this._getChildren().filter(p=>!b(p));let h;if([Er,yn].includes(r.key))h=a[r.key===Er?0:a.length-1];else{const p=[_n,vn].includes(r.key);h=re(a,r.target,p,!0)}h&&(h.focus({preventScroll:!0}),nt.getOrCreateInstance(h).show())}_getChildren(){return j.find(Tr,this._parent)}_getActiveElem(){return this._getChildren().find(r=>this._elemIsActive(r))||null}_setInitialAttributes(r,a){this._setAttributeIfNotExists(r,"role","tablist");for(const h of a)this._setInitialAttributesOnChild(h)}_setInitialAttributesOnChild(r){r=this._getInnerElement(r);const a=this._elemIsActive(r),h=this._getOuterElement(r);r.setAttribute("aria-selected",a),h!==r&&this._setAttributeIfNotExists(h,"role","presentation"),a||r.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(r,"role","tab"),this._setInitialAttributesOnTargetPanel(r)}_setInitialAttributesOnTargetPanel(r){const a=j.getElementFromSelector(r);a&&(this._setAttributeIfNotExists(a,"role","tabpanel"),r.id&&this._setAttributeIfNotExists(a,"aria-labelledby",`${r.id}`))}_toggleDropDown(r,a){const h=this._getOuterElement(r);if(!h.classList.contains("dropdown"))return;const p=(m,v)=>{const E=j.findOne(m,h);E&&E.classList.toggle(v,a)};p(wn,it),p(".dropdown-menu",kr),h.setAttribute("aria-expanded",a)}_setAttributeIfNotExists(r,a,h){r.hasAttribute(a)||r.setAttribute(a,h)}_elemIsActive(r){return r.classList.contains(it)}_getInnerElement(r){return r.matches(Tr)?r:j.findOne(Tr,r)}_getOuterElement(r){return r.closest(".nav-item, .list-group-item")||r}static jQueryInterface(r){return this.each(function(){const a=nt.getOrCreateInstance(this);if(typeof r=="string"){if(a[r]===void 0||r.startsWith("_")||r==="constructor")throw new TypeError(`No method named "${r}"`);a[r]()}})}}k.on(document,El,En,function(c){["A","AREA"].includes(this.tagName)&&c.preventDefault(),b(this)||nt.getOrCreateInstance(this).show()}),k.on(window,Sl,()=>{for(const c of j.find(Ol))nt.getOrCreateInstance(c)}),P(nt);const Ve=".bs.toast",Cl=`mouseover${Ve}`,Rl=`mouseout${Ve}`,Pl=`focusin${Ve}`,Il=`focusout${Ve}`,xl=`hide${Ve}`,$l=`hidden${Ve}`,jl=`show${Ve}`,Ll=`shown${Ve}`,kn="hide",As="show",Os="showing",Nl={animation:"boolean",autohide:"boolean",delay:"number"},Dl={animation:!0,autohide:!0,delay:5e3};class Xt extends Oe{constructor(r,a){super(r,a),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Dl}static get DefaultType(){return Nl}static get NAME(){return"toast"}show(){k.trigger(this._element,jl).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(kn),w(this._element),this._element.classList.add(As,Os),this._queueCallback(()=>{this._element.classList.remove(Os),k.trigger(this._element,Ll),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(k.trigger(this._element,xl).defaultPrevented||(this._element.classList.add(Os),this._queueCallback(()=>{this._element.classList.add(kn),this._element.classList.remove(Os,As),k.trigger(this._element,$l)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(As),super.dispose()}isShown(){return this._element.classList.contains(As)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(r,a){switch(r.type){case"mouseover":case"mouseout":this._hasMouseInteraction=a;break;case"focusin":case"focusout":this._hasKeyboardInteraction=a}if(a)return void this._clearTimeout();const h=r.relatedTarget;this._element===h||this._element.contains(h)||this._maybeScheduleHide()}_setListeners(){k.on(this._element,Cl,r=>this._onInteraction(r,!0)),k.on(this._element,Rl,r=>this._onInteraction(r,!1)),k.on(this._element,Pl,r=>this._onInteraction(r,!0)),k.on(this._element,Il,r=>this._onInteraction(r,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(r){return this.each(function(){const a=Xt.getOrCreateInstance(this,r);if(typeof r=="string"){if(a[r]===void 0)throw new TypeError(`No method named "${r}"`);a[r](this)}})}}return us(Xt),P(Xt),{Alert:Ft,Button:Wt,Carousel:mt,Collapse:vt,Dropdown:Ce,Modal:tt,Offcanvas:qe,Popover:Ts,ScrollSpy:Yt,Tab:nt,Toast:Xt,Tooltip:st}})})(zl);function qs(s,e){var t={};for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&e.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(s);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(s,i[n])&&(t[i[n]]=s[i[n]]);return t}function Gl(s,e,t,i){function n(o){return o instanceof t?o:new t(function(l){l(o)})}return new(t||(t=Promise))(function(o,l){function u(g){try{f(i.next(g))}catch(b){l(b)}}function d(g){try{f(i.throw(g))}catch(b){l(b)}}function f(g){g.done?o(g.value):n(g.value).then(u,d)}f((i=i.apply(s,e||[])).next())})}const Jl=s=>s?(...e)=>s(...e):(...e)=>fetch(...e);class Vr extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class Yl extends Vr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Nn extends Vr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Dn extends Vr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Nr;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(Nr||(Nr={}));class Xl{constructor(e,{headers:t={},customFetch:i,region:n=Nr.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=Jl(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Gl(this,arguments,void 0,function*(t,i={}){var n;let o,l;try{const{headers:u,method:d,body:f,signal:g,timeout:b}=i;let y={},{region:_}=i;_||(_=this.region);const w=new URL(`${this.url}/${t}`);_&&_!=="any"&&(y["x-region"]=_,w.searchParams.set("forceFunctionRegion",_));let S;f&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",S=f):typeof f=="string"?(y["Content-Type"]="text/plain",S=f):typeof FormData<"u"&&f instanceof FormData?S=f:(y["Content-Type"]="application/json",S=JSON.stringify(f)):f&&typeof f!="string"&&!(typeof Blob<"u"&&f instanceof Blob)&&!(f instanceof ArrayBuffer)&&!(typeof FormData<"u"&&f instanceof FormData)?S=JSON.stringify(f):S=f;let O=g;b&&(l=new AbortController,o=setTimeout(()=>l.abort(),b),g?(O=l.signal,g.addEventListener("abort",()=>l.abort())):O=l.signal);const C=yield this.fetch(w.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),u),body:S,signal:O}).catch(re=>{throw new Yl(re)}),P=C.headers.get("x-relay-error");if(P&&P==="true")throw new Nn(C);if(!C.ok)throw new Dn(C);let T=((n=C.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),q;return T==="application/json"?q=yield C.json():T==="application/octet-stream"||T==="application/pdf"?q=yield C.blob():T==="text/event-stream"?q=C:T==="multipart/form-data"?q=yield C.formData():q=yield C.text(),{data:q,error:null,response:C}}catch(u){return{data:null,error:u,response:u instanceof Dn||u instanceof Nn?u.context:void 0}}finally{o&&clearTimeout(o)}})}}var Ql=class extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}},Zl=class{constructor(s){var e,t,i;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(e=s.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=s.signal,this.isMaybeSingle=(t=s.isMaybeSingle)!==null&&t!==void 0?t:!1,this.urlLengthLimit=(i=s.urlLengthLimit)!==null&&i!==void 0?i:8e3,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,e){return this.headers=new Headers(this.headers),this.headers.set(s,e),this}then(s,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let n=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{let l=null,u=null,d=null,f=o.status,g=o.statusText;if(o.ok){var b,y;if(t.method!=="HEAD"){var _;const C=await o.text();C===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((_=t.headers.get("Accept"))===null||_===void 0)&&_.includes("application/vnd.pgrst.plan+text"))?u=C:u=JSON.parse(C))}const S=(b=t.headers.get("Prefer"))===null||b===void 0?void 0:b.match(/count=(exact|planned|estimated)/),O=(y=o.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");S&&O&&O.length>1&&(d=parseInt(O[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(u)&&(u.length>1?(l={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,f=406,g="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var w;const S=await o.text();try{l=JSON.parse(S),Array.isArray(l)&&o.status===404&&(u=[],l=null,f=200,g="OK")}catch{o.status===404&&S===""?(f=204,g="No Content"):l={message:S}}if(l&&t.isMaybeSingle&&(!(l==null||(w=l.details)===null||w===void 0)&&w.includes("0 rows"))&&(l=null,f=200,g="OK"),l&&t.shouldThrowOnError)throw new Ql(l)}return{error:l,data:u,count:d,status:f,statusText:g}});return this.shouldThrowOnError||(n=n.catch(o=>{var l;let u="",d="",f="";const g=o==null?void 0:o.cause;if(g){var b,y,_,w;const C=(b=g==null?void 0:g.message)!==null&&b!==void 0?b:"",P=(y=g==null?void 0:g.code)!==null&&y!==void 0?y:"";u=`${(_=o==null?void 0:o.name)!==null&&_!==void 0?_:"FetchError"}: ${o==null?void 0:o.message}`,u+=`

Caused by: ${(w=g==null?void 0:g.name)!==null&&w!==void 0?w:"Error"}: ${C}`,P&&(u+=` (${P})`),g!=null&&g.stack&&(u+=`
${g.stack}`)}else{var S;u=(S=o==null?void 0:o.stack)!==null&&S!==void 0?S:""}const O=this.url.toString().length;return(o==null?void 0:o.name)==="AbortError"||(o==null?void 0:o.code)==="ABORT_ERR"?(f="",d="Request was aborted (timeout or manual cancellation)",O>this.urlLengthLimit&&(d+=`. Note: Your request URL is ${O} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):((g==null?void 0:g.name)==="HeadersOverflowError"||(g==null?void 0:g.code)==="UND_ERR_HEADERS_OVERFLOW")&&(f="",d="HTTP headers exceeded server limits (typically 16KB)",O>this.urlLengthLimit&&(d+=`. Your request URL is ${O} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(l=o==null?void 0:o.name)!==null&&l!==void 0?l:"FetchError"}: ${o==null?void 0:o.message}`,details:u,hint:d,code:f},data:null,count:null,status:0,statusText:""}})),n.then(s,e)}returns(){return this}overrideTypes(){return this}},ec=class extends Zl{select(s){let e=!1;const t=(s??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:e=!0,nullsFirst:t,foreignTable:i,referencedTable:n=i}={}){const o=n?`${n}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${s}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:e,referencedTable:t=e}={}){const i=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(i,`${s}`),this}range(s,e,{foreignTable:t,referencedTable:i=t}={}){const n=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(n,`${s}`),this.url.searchParams.set(o,`${e-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:e=!1,settings:t=!1,buffers:i=!1,wal:n=!1,format:o="text"}={}){var l;const u=[s?"analyze":null,e?"verbose":null,t?"settings":null,i?"buffers":null,n?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${u};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}};const Un=new RegExp("[,()]");var Lt=class extends ec{eq(s,e){return this.url.searchParams.append(s,`eq.${e}`),this}neq(s,e){return this.url.searchParams.append(s,`neq.${e}`),this}gt(s,e){return this.url.searchParams.append(s,`gt.${e}`),this}gte(s,e){return this.url.searchParams.append(s,`gte.${e}`),this}lt(s,e){return this.url.searchParams.append(s,`lt.${e}`),this}lte(s,e){return this.url.searchParams.append(s,`lte.${e}`),this}like(s,e){return this.url.searchParams.append(s,`like.${e}`),this}likeAllOf(s,e){return this.url.searchParams.append(s,`like(all).{${e.join(",")}}`),this}likeAnyOf(s,e){return this.url.searchParams.append(s,`like(any).{${e.join(",")}}`),this}ilike(s,e){return this.url.searchParams.append(s,`ilike.${e}`),this}ilikeAllOf(s,e){return this.url.searchParams.append(s,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(s,e){return this.url.searchParams.append(s,`ilike(any).{${e.join(",")}}`),this}regexMatch(s,e){return this.url.searchParams.append(s,`match.${e}`),this}regexIMatch(s,e){return this.url.searchParams.append(s,`imatch.${e}`),this}is(s,e){return this.url.searchParams.append(s,`is.${e}`),this}isDistinct(s,e){return this.url.searchParams.append(s,`isdistinct.${e}`),this}in(s,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&Un.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(s,`in.(${t})`),this}notIn(s,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&Un.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(s,`not.in.(${t})`),this}contains(s,e){return typeof e=="string"?this.url.searchParams.append(s,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(s,`cs.{${e.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(e)}`),this}containedBy(s,e){return typeof e=="string"?this.url.searchParams.append(s,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(s,`cd.{${e.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(e)}`),this}rangeGt(s,e){return this.url.searchParams.append(s,`sr.${e}`),this}rangeGte(s,e){return this.url.searchParams.append(s,`nxl.${e}`),this}rangeLt(s,e){return this.url.searchParams.append(s,`sl.${e}`),this}rangeLte(s,e){return this.url.searchParams.append(s,`nxr.${e}`),this}rangeAdjacent(s,e){return this.url.searchParams.append(s,`adj.${e}`),this}overlaps(s,e){return typeof e=="string"?this.url.searchParams.append(s,`ov.${e}`):this.url.searchParams.append(s,`ov.{${e.join(",")}}`),this}textSearch(s,e,{config:t,type:i}={}){let n="";i==="plain"?n="pl":i==="phrase"?n="ph":i==="websearch"&&(n="w");const o=t===void 0?"":`(${t})`;return this.url.searchParams.append(s,`${n}fts${o}.${e}`),this}match(s){return Object.entries(s).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(s,e,t){return this.url.searchParams.append(s,`not.${e}.${t}`),this}or(s,{foreignTable:e,referencedTable:t=e}={}){const i=t?`${t}.or`:"or";return this.url.searchParams.append(i,`(${s})`),this}filter(s,e,t){return this.url.searchParams.append(s,`${e}.${t}`),this}},tc=class{constructor(s,{headers:e={},schema:t,fetch:i,urlLengthLimit:n=8e3}){this.url=s,this.headers=new Headers(e),this.schema=t,this.fetch=i,this.urlLengthLimit=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(s,e){const{head:t=!1,count:i}=e??{},n=t?"HEAD":"GET";let o=!1;const l=(s??"*").split("").map(f=>/\s/.test(f)&&!o?"":(f==='"'&&(o=!o),f)).join(""),{url:u,headers:d}=this.cloneRequestState();return u.searchParams.set("select",l),i&&d.append("Prefer",`count=${i}`),new Lt({method:n,url:u,headers:d,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(s,{count:e,defaultToNull:t=!0}={}){var i;const n="POST",{url:o,headers:l}=this.cloneRequestState();if(e&&l.append("Prefer",`count=${e}`),t||l.append("Prefer","missing=default"),Array.isArray(s)){const u=s.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(u.length>0){const d=[...new Set(u)].map(f=>`"${f}"`);o.searchParams.set("columns",d.join(","))}}return new Lt({method:n,url:o,headers:l,schema:this.schema,body:s,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(s,{onConflict:e,ignoreDuplicates:t=!1,count:i,defaultToNull:n=!0}={}){var o;const l="POST",{url:u,headers:d}=this.cloneRequestState();if(d.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&u.searchParams.set("on_conflict",e),i&&d.append("Prefer",`count=${i}`),n||d.append("Prefer","missing=default"),Array.isArray(s)){const f=s.reduce((g,b)=>g.concat(Object.keys(b)),[]);if(f.length>0){const g=[...new Set(f)].map(b=>`"${b}"`);u.searchParams.set("columns",g.join(","))}}return new Lt({method:l,url:u,headers:d,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch,urlLengthLimit:this.urlLengthLimit})}update(s,{count:e}={}){var t;const i="PATCH",{url:n,headers:o}=this.cloneRequestState();return e&&o.append("Prefer",`count=${e}`),new Lt({method:i,url:n,headers:o,schema:this.schema,body:s,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:s}={}){var e;const t="DELETE",{url:i,headers:n}=this.cloneRequestState();return s&&n.append("Prefer",`count=${s}`),new Lt({method:t,url:i,headers:n,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function ss(s){"@babel/helpers - typeof";return ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ss(s)}function sc(s,e){if(ss(s)!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var i=t.call(s,e);if(ss(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function rc(s){var e=sc(s,"string");return ss(e)=="symbol"?e:e+""}function ic(s,e,t){return(e=rc(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Bn(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function Is(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Bn(Object(t),!0).forEach(function(i){ic(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):Bn(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}var nc=class ao{constructor(e,{headers:t={},schema:i,fetch:n,timeout:o,urlLengthLimit:l=8e3}={}){this.url=e,this.headers=new Headers(t),this.schemaName=i,this.urlLengthLimit=l;const u=n??globalThis.fetch;o!==void 0&&o>0?this.fetch=(d,f)=>{const g=new AbortController,b=setTimeout(()=>g.abort(),o),y=f==null?void 0:f.signal;if(y){if(y.aborted)return clearTimeout(b),u(d,f);const _=()=>{clearTimeout(b),g.abort()};return y.addEventListener("abort",_,{once:!0}),u(d,Is(Is({},f),{},{signal:g.signal})).finally(()=>{clearTimeout(b),y.removeEventListener("abort",_)})}return u(d,Is(Is({},f),{},{signal:g.signal})).finally(()=>clearTimeout(b))}:this.fetch=u}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new tc(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new ao(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,t={},{head:i=!1,get:n=!1,count:o}={}){var l;let u;const d=new URL(`${this.url}/rpc/${e}`);let f;const g=_=>_!==null&&typeof _=="object"&&(!Array.isArray(_)||_.some(g)),b=i&&Object.values(t).some(g);b?(u="POST",f=t):i||n?(u=i?"HEAD":"GET",Object.entries(t).filter(([_,w])=>w!==void 0).map(([_,w])=>[_,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([_,w])=>{d.searchParams.append(_,w)})):(u="POST",f=t);const y=new Headers(this.headers);return b?y.set("Prefer",o?`count=${o},return=minimal`:"return=minimal"):o&&y.set("Prefer",`count=${o}`),new Lt({method:u,url:d,headers:y,schema:this.schemaName,body:f,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch,urlLengthLimit:this.urlLengthLimit})}};class oc{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const i=t.versions;if(i&&i.node){const n=i.node,o=parseInt(n.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const ac="2.97.0",lc=`realtime-js/${ac}`,cc="1.0.0",lo="2.0.0",Mn=lo,Dr=1e4,uc=1e3,hc=100;var Ge;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(Ge||(Ge={}));var ae;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(ae||(ae={}));var xe;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(xe||(xe={}));var Ur;(function(s){s.websocket="websocket"})(Ur||(Ur={}));var ut;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(ut||(ut={}));class dc{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,i;const n=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var t,i;const n=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:{},l=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(e,t,i){var n,o;const l=e.topic,u=(n=e.ref)!==null&&n!==void 0?n:"",d=(o=e.join_ref)!==null&&o!==void 0?o:"",f=e.payload.event,g=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},b=Object.keys(g).length===0?"":JSON.stringify(g);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`userEvent length ${f.length} exceeds maximum of 255`);if(b.length>255)throw new Error(`metadata length ${b.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+u.length+l.length+f.length+b.length,_=new ArrayBuffer(this.HEADER_LENGTH+y);let w=new DataView(_),S=0;w.setUint8(S++,this.KINDS.userBroadcastPush),w.setUint8(S++,d.length),w.setUint8(S++,u.length),w.setUint8(S++,l.length),w.setUint8(S++,f.length),w.setUint8(S++,b.length),w.setUint8(S++,t),Array.from(d,C=>w.setUint8(S++,C.charCodeAt(0))),Array.from(u,C=>w.setUint8(S++,C.charCodeAt(0))),Array.from(l,C=>w.setUint8(S++,C.charCodeAt(0))),Array.from(f,C=>w.setUint8(S++,C.charCodeAt(0))),Array.from(b,C=>w.setUint8(S++,C.charCodeAt(0)));var O=new Uint8Array(_.byteLength+i.byteLength);return O.set(new Uint8Array(_),0),O.set(new Uint8Array(i),_.byteLength),O.buffer}decode(e,t){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return t(i)}if(typeof e=="string"){const i=JSON.parse(e),[n,o,l,u,d]=i;return t({join_ref:n,ref:o,topic:l,event:u,payload:d})}return t({})}_binaryDecode(e){const t=new DataView(e),i=t.getUint8(0),n=new TextDecoder;switch(i){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,n)}}_decodeUserBroadcast(e,t,i){const n=t.getUint8(1),o=t.getUint8(2),l=t.getUint8(3),u=t.getUint8(4);let d=this.HEADER_LENGTH+4;const f=i.decode(e.slice(d,d+n));d=d+n;const g=i.decode(e.slice(d,d+o));d=d+o;const b=i.decode(e.slice(d,d+l));d=d+l;const y=e.slice(d,e.byteLength),_=u===this.JSON_ENCODING?JSON.parse(i.decode(y)):y,w={type:this.BROADCAST_EVENT,event:g,payload:_};return l>0&&(w.meta=JSON.parse(b)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([i])=>t.includes(i)))}}class co{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ee;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(ee||(ee={}));const qn=(s,e,t={})=>{var i;const n=(i=t.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((o,l)=>(o[l]=fc(l,s,e,n),o),{}):{}},fc=(s,e,t,i)=>{const n=e.find(u=>u.name===s),o=n==null?void 0:n.type,l=t[s];return o&&!i.includes(o)?uo(o,l):Br(l)},uo=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return _c(e,t)}switch(s){case ee.bool:return pc(e);case ee.float4:case ee.float8:case ee.int2:case ee.int4:case ee.int8:case ee.numeric:case ee.oid:return gc(e);case ee.json:case ee.jsonb:return mc(e);case ee.timestamp:return vc(e);case ee.abstime:case ee.date:case ee.daterange:case ee.int4range:case ee.int8range:case ee.money:case ee.reltime:case ee.text:case ee.time:case ee.timestamptz:case ee.timetz:case ee.tsrange:case ee.tstzrange:return Br(e);default:return Br(e)}},Br=s=>s,pc=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},gc=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},mc=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch{return s}return s},_c=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,i=s[t];if(s[0]==="{"&&i==="}"){let o;const l=s.slice(1,t);try{o=JSON.parse("["+l+"]")}catch{o=l?l.split(","):[]}return o.map(u=>uo(e,u))}return s},vc=s=>typeof s=="string"?s.replace(" ","T"):s,ho=s=>{const e=new URL(s);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Rr{constructor(e,t,i={},n=Dr){this.channel=e,this.event=t,this.payload=i,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Fn;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(Fn||(Fn={}));class es{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},n=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=es.syncState(this.state,n,o,l),this.pendingDiffs.forEach(d=>{this.state=es.syncDiff(this.state,d,o,l)}),this.pendingDiffs=[],u()}),this.channel._on(i.diff,{},n=>{const{onJoin:o,onLeave:l,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=es.syncDiff(this.state,n,o,l),u())}),this.onJoin((n,o,l)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:o,newPresences:l})}),this.onLeave((n,o,l)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:o,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,n){const o=this.cloneDeep(e),l=this.transformState(t),u={},d={};return this.map(o,(f,g)=>{l[f]||(d[f]=g)}),this.map(l,(f,g)=>{const b=o[f];if(b){const y=g.map(O=>O.presence_ref),_=b.map(O=>O.presence_ref),w=g.filter(O=>_.indexOf(O.presence_ref)<0),S=b.filter(O=>y.indexOf(O.presence_ref)<0);w.length>0&&(u[f]=w),S.length>0&&(d[f]=S)}else u[f]=g}),this.syncDiff(o,{joins:u,leaves:d},i,n)}static syncDiff(e,t,i,n){const{joins:o,leaves:l}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),n||(n=()=>{}),this.map(o,(u,d)=>{var f;const g=(f=e[u])!==null&&f!==void 0?f:[];if(e[u]=this.cloneDeep(d),g.length>0){const b=e[u].map(_=>_.presence_ref),y=g.filter(_=>b.indexOf(_.presence_ref)<0);e[u].unshift(...y)}i(u,g,d)}),this.map(l,(u,d)=>{let f=e[u];if(!f)return;const g=d.map(b=>b.presence_ref);f=f.filter(b=>g.indexOf(b.presence_ref)<0),e[u]=f,n(u,f,d),f.length===0&&delete e[u]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const n=e[i];return"metas"in n?t[i]=n.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):t[i]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Wn;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(Wn||(Wn={}));var ts;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(ts||(ts={}));var Fe;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Fe||(Fe={}));class Ut{constructor(e,t={config:{}},i){var n,o;if(this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=ae.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Rr(this,xe.join,this.params,this.timeout),this.rejoinTimer=new co(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ae.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ae.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=ae.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ae.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=ae.errored,this.rejoinTimer.scheduleTimeout())}),this._on(xe.reply,{},(l,u)=>{this._trigger(this._replyEventName(u),l)}),this.presence=new es(this),this.broadcastEndpointURL=ho(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var i,n,o;if(this.socket.isConnected()||this.socket.connect(),this.state==ae.closed){const{config:{broadcast:l,presence:u,private:d}}=this.params,f=(n=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(_=>_.filter))!==null&&n!==void 0?n:[],g=!!this.bindings[ts.PRESENCE]&&this.bindings[ts.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,b={},y={broadcast:l,presence:Object.assign(Object.assign({},u),{enabled:g}),postgres_changes:f,private:d};this.socket.accessTokenValue&&(b.access_token=this.socket.accessTokenValue),this._onError(_=>e==null?void 0:e(Fe.CHANNEL_ERROR,_)),this._onClose(()=>e==null?void 0:e(Fe.CLOSED)),this.updateJoinPayload(Object.assign({config:y},b)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:_})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),_===void 0){e==null||e(Fe.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,O=(w=S==null?void 0:S.length)!==null&&w!==void 0?w:0,C=[];for(let P=0;P<O;P++){const T=S[P],{filter:{event:q,schema:re,table:J,filter:ie}}=T,$e=_&&_[P];if($e&&$e.event===q&&Ut.isFilterValueEqual($e.schema,re)&&Ut.isFilterValueEqual($e.table,J)&&Ut.isFilterValueEqual($e.filter,ie))C.push(Object.assign(Object.assign({},T),{id:$e.id}));else{this.unsubscribe(),this.state=ae.errored,e==null||e(Fe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=C,e&&e(Fe.SUBSCRIBED);return}}).receive("error",_=>{this.state=ae.errored,e==null||e(Fe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Fe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===ae.joined&&e===ts.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,i)}async httpSend(e,t,i={}){var n;if(t==null)return Promise.reject("Payload is required for httpSend()");const o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=i.timeout)!==null&&n!==void 0?n:this.timeout);if(u.status===202)return{success:!0};let d=u.statusText;try{const f=await u.json();d=f.error||f.message||d}catch{}return Promise.reject(new Error(d))}async send(e,t={}){var i,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:l}=e,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((n=f.body)===null||n===void 0?void 0:n.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var l,u,d;const f=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(u=(l=this.params)===null||l===void 0?void 0:l.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.ack)&&o("ok"),f.receive("ok",()=>o("ok")),f.receive("error",()=>o("error")),f.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ae.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(xe.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(n=>{i=new Rr(this,xe.leave,{},e),i.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i==null||i.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ae.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const n=new AbortController,o=setTimeout(()=>n.abort(),i),l=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(o),l}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Rr(this,e,t,i);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>hc){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var n,o;const l=e.toLocaleLowerCase(),{close:u,error:d,leave:f,join:g}=xe;if(i&&[u,d,f,g].indexOf(l)>=0&&i!==this._joinRef())return;let y=this._onMessage(l,t,i);if(t&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(_=>{var w,S,O;return((w=_.filter)===null||w===void 0?void 0:w.event)==="*"||((O=(S=_.filter)===null||S===void 0?void 0:S.event)===null||O===void 0?void 0:O.toLocaleLowerCase())===l}).map(_=>_.callback(y,i)):(o=this.bindings[l])===null||o===void 0||o.filter(_=>{var w,S,O,C,P,T;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in _){const q=_.id,re=(w=_.filter)===null||w===void 0?void 0:w.event;return q&&((S=t.ids)===null||S===void 0?void 0:S.includes(q))&&(re==="*"||(re==null?void 0:re.toLocaleLowerCase())===((O=t.data)===null||O===void 0?void 0:O.type.toLocaleLowerCase()))}else{const q=(P=(C=_==null?void 0:_.filter)===null||C===void 0?void 0:C.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return q==="*"||q===((T=t==null?void 0:t.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===l}).map(_=>{if(typeof y=="object"&&"ids"in y){const w=y.data,{schema:S,table:O,commit_timestamp:C,type:P,errors:T}=w;y=Object.assign(Object.assign({},{schema:S,table:O,commit_timestamp:C,eventType:P,new:{},old:{},errors:T}),this._getPayloadRecords(w))}_.callback(y,i)})}_isClosed(){return this.state===ae.closed}_isJoined(){return this.state===ae.joined}_isJoining(){return this.state===ae.joining}_isLeaving(){return this.state===ae.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const n=e.toLocaleLowerCase(),o={type:n,filter:t,callback:i};return this.bindings[n]?this.bindings[n].push(o):this.bindings[n]=[o],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(n=>{var o;return!(((o=n.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===i&&Ut.isEqual(n.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(xe.close,{},e)}_onError(e){this._on(xe.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ae.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=qn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=qn(e.columns,e.old_record)),t}}const Pr=()=>{},xs={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},yc=[1e3,2e3,5e3,1e4],bc=1e4,wc=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ec{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Dr,this.transport=null,this.heartbeatIntervalMs=xs.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Pr,this.ref=0,this.reconnectTimer=null,this.vsn=Mn,this.logger=Pr,this.conn=null,this.sendBuffer=[],this.serializer=new dc,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=n=>n?(...o)=>n(...o):(...o)=>fetch(...o),!(!((i=t==null?void 0:t.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Ur.websocket}`,this.httpEndpoint=ho(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=oc.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Ge.connecting:return ut.Connecting;case Ge.open:return ut.Open;case Ge.closing:return ut.Closing;default:return ut.Closed}}isConnected(){return this.connectionState()===ut.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,n=this.getChannels().find(o=>o.topic===i);if(n)return n;{const o=new Ut(`realtime:${e}`,t,this);return this.channels.push(o),o}}push(e){const{topic:t,event:i,payload:n,ref:o}=e,l=()=>{this.encode(e,u=>{var d;(d=this.conn)===null||d===void 0||d.send(u)})};this.log("push",`${t} ${i} (${o})`,n),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(uc,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},xs.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const f=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",f)}catch(g){this.log("error","error in heartbeat callback",g)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:i,event:n,payload:o,ref:l}=t,u=l?`(${l})`:"",d=o.status||"";this.log("receive",`${d} ${i} ${n} ${u}`.trim(),o),this.channels.filter(f=>f._isMember(i)).forEach(f=>f._trigger(n,o,l)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Ge.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ge.open||this.conn.readyState===Ge.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(xe.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${i}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([wc],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,i=!1;if(e)t=e,i=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),t=this.accessTokenValue}else t=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const o={access_token:t,version:lc};t&&n.updateJoinPayload(o),n.joinedOnce&&n._isJoined()&&n._push(xe.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new co(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},xs.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,n,o,l,u,d,f,g,b,y,_;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e==null?void 0:e.timeout)!==null&&i!==void 0?i:Dr,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:xs.HEARTBEAT_INTERVAL,this.worker=(o=e==null?void 0:e.worker)!==null&&o!==void 0?o:!1,this.accessToken=(l=e==null?void 0:e.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(u=e==null?void 0:e.heartbeatCallback)!==null&&u!==void 0?u:Pr,this.vsn=(d=e==null?void 0:e.vsn)!==null&&d!==void 0?d:Mn,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e==null?void 0:e.reconnectAfterMs)!==null&&f!==void 0?f:w=>yc[w-1]||bc,this.vsn){case cc:this.encode=(g=e==null?void 0:e.encode)!==null&&g!==void 0?g:(w,S)=>S(JSON.stringify(w)),this.decode=(b=e==null?void 0:e.decode)!==null&&b!==void 0?b:(w,S)=>S(JSON.parse(w));break;case lo:this.encode=(y=e==null?void 0:e.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(_=e==null?void 0:e.decode)!==null&&_!==void 0?_:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}var rs=class extends Error{constructor(s,e){var t;super(s),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function kc(s,e,t){const i=new URL(e,s);if(t)for(const[n,o]of Object.entries(t))o!==void 0&&i.searchParams.set(n,o);return i.toString()}async function Sc(s){return!s||s.type==="none"?{}:s.type==="bearer"?{Authorization:`Bearer ${s.token}`}:s.type==="header"?{[s.name]:s.value}:s.type==="custom"?await s.getHeaders():{}}function Tc(s){const e=s.fetchImpl??globalThis.fetch;return{async request({method:t,path:i,query:n,body:o,headers:l}){const u=kc(s.baseUrl,i,n),d=await Sc(s.auth),f=await e(u,{method:t,headers:{...o?{"Content-Type":"application/json"}:{},...d,...l},body:o?JSON.stringify(o):void 0}),g=await f.text(),b=(f.headers.get("content-type")||"").includes("application/json"),y=b&&g?JSON.parse(g):g;if(!f.ok){const _=b?y:void 0,w=_==null?void 0:_.error;throw new rs((w==null?void 0:w.message)??`Request failed with status ${f.status}`,{status:f.status,icebergType:w==null?void 0:w.type,icebergCode:w==null?void 0:w.code,details:_})}return{status:f.status,headers:f.headers,data:y}}}}function $s(s){return s.join("")}var Ac=class{constructor(s,e=""){this.client=s,this.prefix=e}async listNamespaces(s){const e=s?{parent:$s(s.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(i=>({namespace:i}))}async createNamespace(s,e){const t={namespace:s.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${$s(s.namespace)}`})}async loadNamespaceMetadata(s){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${$s(s.namespace)}`})).data.properties}}async namespaceExists(s){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${$s(s.namespace)}`}),!0}catch(e){if(e instanceof rs&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(s,e){try{return await this.createNamespace(s,e)}catch(t){if(t instanceof rs&&t.status===409)return;throw t}}};function Rt(s){return s.join("")}var Oc=class{constructor(s,e="",t){this.client=s,this.prefix=e,this.accessDelegation=t}async listTables(s){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Rt(s.namespace)}/tables`})).data.identifiers}async createTable(s,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Rt(s.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(s,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Rt(s.namespace)}/tables/${s.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(s,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Rt(s.namespace)}/tables/${s.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(s){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Rt(s.namespace)}/tables/${s.name}`,headers:e})).data.metadata}async tableExists(s){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Rt(s.namespace)}/tables/${s.name}`,headers:e}),!0}catch(t){if(t instanceof rs&&t.status===404)return!1;throw t}}async createTableIfNotExists(s,e){try{return await this.createTable(s,e)}catch(t){if(t instanceof rs&&t.status===409)return await this.loadTable({namespace:s.namespace,name:e.name});throw t}}},Cc=class{constructor(s){var i;let e="v1";s.catalogName&&(e+=`/${s.catalogName}`);const t=s.baseUrl.endsWith("/")?s.baseUrl:`${s.baseUrl}/`;this.client=Tc({baseUrl:t,auth:s.auth,fetchImpl:s.fetch}),this.accessDelegation=(i=s.accessDelegation)==null?void 0:i.join(","),this.namespaceOps=new Ac(this.client,e),this.tableOps=new Oc(this.client,e,this.accessDelegation)}async listNamespaces(s){return this.namespaceOps.listNamespaces(s)}async createNamespace(s,e){return this.namespaceOps.createNamespace(s,e)}async dropNamespace(s){await this.namespaceOps.dropNamespace(s)}async loadNamespaceMetadata(s){return this.namespaceOps.loadNamespaceMetadata(s)}async listTables(s){return this.tableOps.listTables(s)}async createTable(s,e){return this.tableOps.createTable(s,e)}async updateTable(s,e){return this.tableOps.updateTable(s,e)}async dropTable(s,e){await this.tableOps.dropTable(s,e)}async loadTable(s){return this.tableOps.loadTable(s)}async namespaceExists(s){return this.namespaceOps.namespaceExists(s)}async tableExists(s){return this.tableOps.tableExists(s)}async createNamespaceIfNotExists(s,e){return this.namespaceOps.createNamespaceIfNotExists(s,e)}async createTableIfNotExists(s,e){return this.tableOps.createTableIfNotExists(s,e)}},Fs=class extends Error{constructor(s,e="storage",t,i){super(s),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=t,this.statusCode=i}};function Ws(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}var js=class extends Fs{constructor(s,e,t,i="storage"){super(s,i,e,t),this.name=i==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},fo=class extends Fs{constructor(s,e,t="storage"){super(s,t),this.name=t==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const Rc=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),Pc=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},Mr=s=>{if(Array.isArray(s))return s.map(t=>Mr(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,i])=>{const n=t.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[n]=Mr(i)}),e},Ic=s=>!s||typeof s!="string"||s.length===0||s.length>100||s.trim()!==s||s.includes("/")||s.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(s);function is(s){"@babel/helpers - typeof";return is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},is(s)}function xc(s,e){if(is(s)!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var i=t.call(s,e);if(is(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function $c(s){var e=xc(s,"string");return is(e)=="symbol"?e:e+""}function jc(s,e,t){return(e=$c(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Hn(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function L(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Hn(Object(t),!0).forEach(function(i){jc(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):Hn(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}const Kn=s=>{var e;return s.msg||s.message||s.error_description||(typeof s.error=="string"?s.error:(e=s.error)===null||e===void 0?void 0:e.message)||JSON.stringify(s)},Lc=async(s,e,t,i)=>{if(s&&typeof s=="object"&&"status"in s&&"ok"in s&&typeof s.status=="number"&&!(t!=null&&t.noResolveJson)){const n=s,o=n.status||500;if(typeof n.json=="function")n.json().then(l=>{const u=(l==null?void 0:l.statusCode)||(l==null?void 0:l.code)||o+"";e(new js(Kn(l),o,u,i))}).catch(()=>{if(i==="vectors"){const l=o+"";e(new js(n.statusText||`HTTP ${o} error`,o,l,i))}else{const l=o+"";e(new js(n.statusText||`HTTP ${o} error`,o,l,i))}});else{const l=o+"";e(new js(n.statusText||`HTTP ${o} error`,o,l,i))}}else e(new fo(Kn(s),s,i))},Nc=(s,e,t,i)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"||s==="HEAD"||!i?L(L({},n),t):(Pc(i)?(n.headers=L({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(i)):n.body=i,e!=null&&e.duplex&&(n.duplex=e.duplex),L(L({},n),t))};async function Qt(s,e,t,i,n,o,l){return new Promise((u,d)=>{s(t,Nc(e,i,n,o)).then(f=>{if(!f.ok)throw f;if(i!=null&&i.noResolveJson)return f;if(l==="vectors"){const g=f.headers.get("content-type");if(f.headers.get("content-length")==="0"||f.status===204)return{};if(!g||!g.includes("application/json"))return{}}return f.json()}).then(f=>u(f)).catch(f=>Lc(f,d,i,l))})}function po(s="storage"){return{get:async(e,t,i,n)=>Qt(e,"GET",t,i,n,void 0,s),post:async(e,t,i,n,o)=>Qt(e,"POST",t,n,o,i,s),put:async(e,t,i,n,o)=>Qt(e,"PUT",t,n,o,i,s),head:async(e,t,i,n)=>Qt(e,"HEAD",t,L(L({},i),{},{noResolveJson:!0}),n,void 0,s),remove:async(e,t,i,n,o)=>Qt(e,"DELETE",t,n,o,i,s)}}const Dc=po("storage"),{get:ns,post:Ie,put:qr,head:Uc,remove:zr}=Dc,we=po("vectors");var Mt=class{constructor(s,e={},t,i="storage"){this.shouldThrowOnError=!1,this.url=s,this.headers=e,this.fetch=Rc(t),this.namespace=i}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,e){return this.headers=L(L({},this.headers),{},{[s]:e}),this}async handleOperation(s){var e=this;try{return{data:await s(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ws(t))return{data:null,error:t};throw t}}},Bc=class{constructor(s,e){this.downloadFn=s,this.shouldThrowOnError=e}then(s,e){return this.execute().then(s,e)}async execute(){var s=this;try{return{data:(await s.downloadFn()).body,error:null}}catch(e){if(s.shouldThrowOnError)throw e;if(Ws(e))return{data:null,error:e};throw e}}};let go;go=Symbol.toStringTag;var Mc=class{constructor(s,e){this.downloadFn=s,this.shouldThrowOnError=e,this[go]="BlobDownloadBuilder",this.promise=null}asStream(){return new Bc(this.downloadFn,this.shouldThrowOnError)}then(s,e){return this.getPromise().then(s,e)}catch(s){return this.getPromise().catch(s)}finally(s){return this.getPromise().finally(s)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var s=this;try{return{data:await(await s.downloadFn()).blob(),error:null}}catch(e){if(s.shouldThrowOnError)throw e;if(Ws(e))return{data:null,error:e};throw e}}};const qc={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Vn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Fc=class extends Mt{constructor(s,e={},t,i){super(s,e,i,"storage"),this.bucketId=t}async uploadOrUpdate(s,e,t,i){var n=this;return n.handleOperation(async()=>{let o;const l=L(L({},Vn),i);let u=L(L({},n.headers),s==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&t instanceof Blob?(o=new FormData,o.append("cacheControl",l.cacheControl),d&&o.append("metadata",n.encodeMetadata(d)),o.append("",t)):typeof FormData<"u"&&t instanceof FormData?(o=t,o.has("cacheControl")||o.append("cacheControl",l.cacheControl),d&&!o.has("metadata")&&o.append("metadata",n.encodeMetadata(d))):(o=t,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType,d&&(u["x-metadata"]=n.toBase64(n.encodeMetadata(d))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!l.duplex&&(l.duplex="half")),i!=null&&i.headers&&(u=L(L({},u),i.headers));const f=n._removeEmptyFolders(e),g=n._getFinalPath(f),b=await(s=="PUT"?qr:Ie)(n.fetch,`${n.url}/object/${g}`,o,L({headers:u},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{path:f,id:b.Id,fullPath:b.Key}})}async upload(s,e,t){return this.uploadOrUpdate("POST",s,e,t)}async uploadToSignedUrl(s,e,t,i){var n=this;const o=n._removeEmptyFolders(s),l=n._getFinalPath(o),u=new URL(n.url+`/object/upload/sign/${l}`);return u.searchParams.set("token",e),n.handleOperation(async()=>{let d;const f=L({upsert:Vn.upsert},i),g=L(L({},n.headers),{"x-upsert":String(f.upsert)});return typeof Blob<"u"&&t instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",t)):typeof FormData<"u"&&t instanceof FormData?(d=t,d.append("cacheControl",f.cacheControl)):(d=t,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType),{path:o,fullPath:(await qr(n.fetch,u.toString(),d,{headers:g})).Key}})}async createSignedUploadUrl(s,e){var t=this;return t.handleOperation(async()=>{let i=t._getFinalPath(s);const n=L({},t.headers);e!=null&&e.upsert&&(n["x-upsert"]="true");const o=await Ie(t.fetch,`${t.url}/object/upload/sign/${i}`,{},{headers:n}),l=new URL(t.url+o.url),u=l.searchParams.get("token");if(!u)throw new Fs("No token returned by API");return{signedUrl:l.toString(),path:s,token:u}})}async update(s,e,t){return this.uploadOrUpdate("PUT",s,e,t)}async move(s,e,t){var i=this;return i.handleOperation(async()=>await Ie(i.fetch,`${i.url}/object/move`,{bucketId:i.bucketId,sourceKey:s,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:i.headers}))}async copy(s,e,t){var i=this;return i.handleOperation(async()=>({path:(await Ie(i.fetch,`${i.url}/object/copy`,{bucketId:i.bucketId,sourceKey:s,destinationKey:e,destinationBucket:t==null?void 0:t.destinationBucket},{headers:i.headers})).Key}))}async createSignedUrl(s,e,t){var i=this;return i.handleOperation(async()=>{let n=i._getFinalPath(s),o=await Ie(i.fetch,`${i.url}/object/sign/${n}`,L({expiresIn:e},t!=null&&t.transform?{transform:t.transform}:{}),{headers:i.headers});const l=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{signedUrl:encodeURI(`${i.url}${o.signedURL}${l}`)}})}async createSignedUrls(s,e,t){var i=this;return i.handleOperation(async()=>{const n=await Ie(i.fetch,`${i.url}/object/sign/${i.bucketId}`,{expiresIn:e,paths:s},{headers:i.headers}),o=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return n.map(l=>L(L({},l),{},{signedUrl:l.signedURL?encodeURI(`${i.url}${l.signedURL}${o}`):null}))})}download(s,e,t){const i=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),o=n?`?${n}`:"",l=this._getFinalPath(s),u=()=>ns(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0},t);return new Mc(u,this.shouldThrowOnError)}async info(s){var e=this;const t=e._getFinalPath(s);return e.handleOperation(async()=>Mr(await ns(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})))}async exists(s){var e=this;const t=e._getFinalPath(s);try{return await Uc(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(Ws(i)&&i instanceof fo){const n=i.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:i}}throw i}}getPublicUrl(s,e){const t=this._getFinalPath(s),i=[],n=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&i.push(n);const o=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});l!==""&&i.push(l);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${t}${u}`)}}}async remove(s){var e=this;return e.handleOperation(async()=>await zr(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:s},{headers:e.headers}))}async list(s,e,t){var i=this;return i.handleOperation(async()=>{const n=L(L(L({},qc),e),{},{prefix:s||""});return await Ie(i.fetch,`${i.url}/object/list/${i.bucketId}`,n,{headers:i.headers},t)})}async listV2(s,e){var t=this;return t.handleOperation(async()=>{const i=L({},s);return await Ie(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,i,{headers:t.headers},e)})}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s.replace(/^\/+/,"")}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const e=[];return s.width&&e.push(`width=${s.width}`),s.height&&e.push(`height=${s.height}`),s.resize&&e.push(`resize=${s.resize}`),s.format&&e.push(`format=${s.format}`),s.quality&&e.push(`quality=${s.quality}`),e.join("&")}};const Wc="2.97.0",cs={"X-Client-Info":`storage-js/${Wc}`};var Hc=class extends Mt{constructor(s,e={},t,i){const n=new URL(s);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase."));const o=n.href.replace(/\/$/,""),l=L(L({},cs),e);super(o,l,t,"storage")}async listBuckets(s){var e=this;return e.handleOperation(async()=>{const t=e.listBucketOptionsToQueryString(s);return await ns(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers})})}async getBucket(s){var e=this;return e.handleOperation(async()=>await ns(e.fetch,`${e.url}/bucket/${s}`,{headers:e.headers}))}async createBucket(s,e={public:!1}){var t=this;return t.handleOperation(async()=>await Ie(t.fetch,`${t.url}/bucket`,{id:s,name:s,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async updateBucket(s,e){var t=this;return t.handleOperation(async()=>await qr(t.fetch,`${t.url}/bucket/${s}`,{id:s,name:s,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}))}async emptyBucket(s){var e=this;return e.handleOperation(async()=>await Ie(e.fetch,`${e.url}/bucket/${s}/empty`,{},{headers:e.headers}))}async deleteBucket(s){var e=this;return e.handleOperation(async()=>await zr(e.fetch,`${e.url}/bucket/${s}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(s){const e={};return s&&("limit"in s&&(e.limit=String(s.limit)),"offset"in s&&(e.offset=String(s.offset)),s.search&&(e.search=s.search),s.sortColumn&&(e.sortColumn=s.sortColumn),s.sortOrder&&(e.sortOrder=s.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},Kc=class extends Mt{constructor(s,e={},t){const i=s.replace(/\/$/,""),n=L(L({},cs),e);super(i,n,t,"storage")}async createBucket(s){var e=this;return e.handleOperation(async()=>await Ie(e.fetch,`${e.url}/bucket`,{name:s},{headers:e.headers}))}async listBuckets(s){var e=this;return e.handleOperation(async()=>{const t=new URLSearchParams;(s==null?void 0:s.limit)!==void 0&&t.set("limit",s.limit.toString()),(s==null?void 0:s.offset)!==void 0&&t.set("offset",s.offset.toString()),s!=null&&s.sortColumn&&t.set("sortColumn",s.sortColumn),s!=null&&s.sortOrder&&t.set("sortOrder",s.sortOrder),s!=null&&s.search&&t.set("search",s.search);const i=t.toString(),n=i?`${e.url}/bucket?${i}`:`${e.url}/bucket`;return await ns(e.fetch,n,{headers:e.headers})})}async deleteBucket(s){var e=this;return e.handleOperation(async()=>await zr(e.fetch,`${e.url}/bucket/${s}`,{},{headers:e.headers}))}from(s){var e=this;if(!Ic(s))throw new Fs("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new Cc({baseUrl:this.url,catalogName:s,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(t,{get(n,o){const l=n[o];return typeof l!="function"?l:async(...u)=>{try{return{data:await l.apply(n,u),error:null}}catch(d){if(i)throw d;return{data:null,error:d}}}}})}},Vc=class extends Mt{constructor(s,e={},t){const i=s.replace(/\/$/,""),n=L(L({},cs),{},{"Content-Type":"application/json"},e);super(i,n,t,"vectors")}async createIndex(s){var e=this;return e.handleOperation(async()=>await we.post(e.fetch,`${e.url}/CreateIndex`,s,{headers:e.headers})||{})}async getIndex(s,e){var t=this;return t.handleOperation(async()=>await we.post(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:s,indexName:e},{headers:t.headers}))}async listIndexes(s){var e=this;return e.handleOperation(async()=>await we.post(e.fetch,`${e.url}/ListIndexes`,s,{headers:e.headers}))}async deleteIndex(s,e){var t=this;return t.handleOperation(async()=>await we.post(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:s,indexName:e},{headers:t.headers})||{})}},zc=class extends Mt{constructor(s,e={},t){const i=s.replace(/\/$/,""),n=L(L({},cs),{},{"Content-Type":"application/json"},e);super(i,n,t,"vectors")}async putVectors(s){var e=this;if(s.vectors.length<1||s.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await we.post(e.fetch,`${e.url}/PutVectors`,s,{headers:e.headers})||{})}async getVectors(s){var e=this;return e.handleOperation(async()=>await we.post(e.fetch,`${e.url}/GetVectors`,s,{headers:e.headers}))}async listVectors(s){var e=this;if(s.segmentCount!==void 0){if(s.segmentCount<1||s.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(s.segmentIndex!==void 0&&(s.segmentIndex<0||s.segmentIndex>=s.segmentCount))throw new Error(`segmentIndex must be between 0 and ${s.segmentCount-1}`)}return e.handleOperation(async()=>await we.post(e.fetch,`${e.url}/ListVectors`,s,{headers:e.headers}))}async queryVectors(s){var e=this;return e.handleOperation(async()=>await we.post(e.fetch,`${e.url}/QueryVectors`,s,{headers:e.headers}))}async deleteVectors(s){var e=this;if(s.keys.length<1||s.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await we.post(e.fetch,`${e.url}/DeleteVectors`,s,{headers:e.headers})||{})}},Gc=class extends Mt{constructor(s,e={},t){const i=s.replace(/\/$/,""),n=L(L({},cs),{},{"Content-Type":"application/json"},e);super(i,n,t,"vectors")}async createBucket(s){var e=this;return e.handleOperation(async()=>await we.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:s},{headers:e.headers})||{})}async getBucket(s){var e=this;return e.handleOperation(async()=>await we.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:s},{headers:e.headers}))}async listBuckets(s={}){var e=this;return e.handleOperation(async()=>await we.post(e.fetch,`${e.url}/ListVectorBuckets`,s,{headers:e.headers}))}async deleteBucket(s){var e=this;return e.handleOperation(async()=>await we.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:s},{headers:e.headers})||{})}},Jc=class extends Gc{constructor(s,e={}){super(s,e.headers||{},e.fetch)}from(s){return new Yc(this.url,this.headers,s,this.fetch)}async createBucket(s){var e=()=>super.createBucket,t=this;return e().call(t,s)}async getBucket(s){var e=()=>super.getBucket,t=this;return e().call(t,s)}async listBuckets(s={}){var e=()=>super.listBuckets,t=this;return e().call(t,s)}async deleteBucket(s){var e=()=>super.deleteBucket,t=this;return e().call(t,s)}},Yc=class extends Vc{constructor(s,e,t,i){super(s,e,i),this.vectorBucketName=t}async createIndex(s){var e=()=>super.createIndex,t=this;return e().call(t,L(L({},s),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(s={}){var e=()=>super.listIndexes,t=this;return e().call(t,L(L({},s),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(s){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,s)}async deleteIndex(s){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,s)}index(s){return new Xc(this.url,this.headers,this.vectorBucketName,s,this.fetch)}},Xc=class extends zc{constructor(s,e,t,i,n){super(s,e,n),this.vectorBucketName=t,this.indexName=i}async putVectors(s){var e=()=>super.putVectors,t=this;return e().call(t,L(L({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(s){var e=()=>super.getVectors,t=this;return e().call(t,L(L({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(s={}){var e=()=>super.listVectors,t=this;return e().call(t,L(L({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(s){var e=()=>super.queryVectors,t=this;return e().call(t,L(L({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(s){var e=()=>super.deleteVectors,t=this;return e().call(t,L(L({},s),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},Qc=class extends Hc{constructor(s,e={},t,i){super(s,e,t,i)}from(s){return new Fc(this.url,this.headers,s,this.fetch)}get vectors(){return new Jc(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Kc(this.url+"/iceberg",this.headers,this.fetch)}};const mo="2.97.0",Nt=30*1e3,Fr=3,Ir=Fr*Nt,Zc="http://localhost:9999",eu="supabase.auth.token",tu={"X-Client-Info":`gotrue-js/${mo}`},Wr="X-Supabase-Api-Version",_o={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},su=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ru=10*60*1e3;class os extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function $(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class iu extends os{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function nu(s){return $(s)&&s.name==="AuthApiError"}class ht extends os{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class We extends os{constructor(e,t,i,n){super(e,i,n),this.name=t,this.status=i}}class be extends We{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function xr(s){return $(s)&&s.name==="AuthSessionMissingError"}class Pt extends We{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ls extends We{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ns extends We{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ou(s){return $(s)&&s.name==="AuthImplicitGrantRedirectError"}class zn extends We{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class au extends We{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Hr extends We{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function $r(s){return $(s)&&s.name==="AuthRetryableFetchError"}class Gn extends We{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class Kr extends We{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Us="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Jn=` 	
\r=`.split(""),lu=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<Jn.length;e+=1)s[Jn[e].charCodeAt(0)]=-2;for(let e=0;e<Us.length;e+=1)s[Us[e].charCodeAt(0)]=e;return s})();function Yn(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Us[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Us[i]),e.queuedBits-=6}}function vo(s,e,t){const i=lu[s];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function Xn(s){const e=[],t=l=>{e.push(String.fromCodePoint(l))},i={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},o=l=>{hu(l,i,t)};for(let l=0;l<s.length;l+=1)vo(s.charCodeAt(l),n,o);return e.join("")}function cu(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function uu(s,e){for(let t=0;t<s.length;t+=1){let i=s.charCodeAt(t);if(i>55295&&i<=56319){const n=(i-55296)*1024&65535;i=(s.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}cu(i,e)}}function hu(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let i=1;i<6;i+=1)if(!(s>>7-i&1)){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Bt(s){const e=[],t={queue:0,queuedBits:0},i=n=>{e.push(n)};for(let n=0;n<s.length;n+=1)vo(s.charCodeAt(n),t,i);return new Uint8Array(e)}function du(s){const e=[];return uu(s,t=>e.push(t)),new Uint8Array(e)}function dt(s){const e=[],t={queue:0,queuedBits:0},i=n=>{e.push(n)};return s.forEach(n=>Yn(n,t,i)),Yn(null,t,i),e.join("")}function fu(s){return Math.round(Date.now()/1e3)+s}function pu(){return Symbol("auth-callback")}const ue=()=>typeof window<"u"&&typeof document<"u",at={tested:!1,writable:!1},yo=()=>{if(!ue())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(at.tested)return at.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),at.tested=!0,at.writable=!0}catch{at.tested=!0,at.writable=!1}return at.writable};function gu(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,o)=>{e[o]=n})}catch{}return t.searchParams.forEach((i,n)=>{e[n]=i}),e}const bo=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),mu=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",Dt=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},lt=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ce=async(s,e)=>{await s.removeItem(e)};class Hs{constructor(){this.promise=new Hs.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Hs.promiseConstructor=Promise;function Ds(s){const e=s.split(".");if(e.length!==3)throw new Kr("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!su.test(e[i]))throw new Kr("JWT not in base64url format");return{header:JSON.parse(Xn(e[0])),payload:JSON.parse(Xn(e[1])),signature:Bt(e[2]),raw:{header:e[0],payload:e[1]}}}async function _u(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function vu(s,e){return new Promise((i,n)=>{(async()=>{for(let o=0;o<1/0;o++)try{const l=await s(o);if(!e(o,null,l)){i(l);return}}catch(l){if(!e(o,l)){n(l);return}}})()})}function yu(s){return("0"+s.toString(16)).substr(-2)}function bu(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let n="";for(let o=0;o<56;o++)n+=t.charAt(Math.floor(Math.random()*i));return n}return crypto.getRandomValues(e),Array.from(e,yu).join("")}async function wu(s){const t=new TextEncoder().encode(s),i=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(i);return Array.from(n).map(o=>String.fromCharCode(o)).join("")}async function Eu(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await wu(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function It(s,e,t=!1){const i=bu();let n=i;t&&(n+="/PASSWORD_RECOVERY"),await Dt(s,`${e}-code-verifier`,n);const o=await Eu(i);return[o,i===o?"plain":"s256"]}const ku=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Su(s){const e=s.headers.get(Wr);if(!e||!e.match(ku))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Tu(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function Au(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ou=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xt(s){if(!Ou.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function jr(){const s={};return new Proxy(s,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Cu(s,e){return new Proxy(s,{get:(t,i,n)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const o=i.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,i,n)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,i,n)}})}function Qn(s){return JSON.parse(JSON.stringify(s))}const ct=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),Ru=[502,503,504];async function Zn(s){var e;if(!mu(s))throw new Hr(ct(s),0);if(Ru.includes(s.status))throw new Hr(ct(s),s.status);let t;try{t=await s.json()}catch(o){throw new ht(ct(o),o)}let i;const n=Su(s);if(n&&n.getTime()>=_o["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new Gn(ct(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new be}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((o,l)=>o&&typeof l=="string",!0))throw new Gn(ct(t),s.status,t.weak_password.reasons);throw new iu(ct(t),s.status||500,i)}const Pu=(s,e,t,i)=>{const n={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(i),Object.assign(Object.assign({},n),t))};async function N(s,e,t,i){var n;const o=Object.assign({},i==null?void 0:i.headers);o[Wr]||(o[Wr]=_o["2024-01-01"].name),i!=null&&i.jwt&&(o.Authorization=`Bearer ${i.jwt}`);const l=(n=i==null?void 0:i.query)!==null&&n!==void 0?n:{};i!=null&&i.redirectTo&&(l.redirect_to=i.redirectTo);const u=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await Iu(s,e,t+u,{headers:o,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(d):{data:Object.assign({},d),error:null}}async function Iu(s,e,t,i,n,o){const l=Pu(e,i,n,o);let u;try{u=await s(t,Object.assign({},l))}catch(d){throw console.error(d),new Hr(ct(d),0)}if(u.ok||await Zn(u),i!=null&&i.noResolveJson)return u;try{return await u.json()}catch(d){await Zn(d)}}function Pe(s){var e;let t=null;ju(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=fu(s.expires_in)));const i=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:i},error:null}}function eo(s){const e=Pe(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=s.weak_password),e}function Je(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function xu(s){return{data:s,error:null}}function $u(s){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:n,verification_type:o}=s,l=qs(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:e,email_otp:t,hashed_token:i,redirect_to:n,verification_type:o},d=Object.assign({},l);return{data:{properties:u,user:d},error:null}}function to(s){return s}function ju(s){return s.access_token&&s.refresh_token&&s.expires_in}const Lr=["global","local","others"];class Lu{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=bo(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Lr[0]){if(Lr.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Lr.join(", ")}`);try{return await N(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if($(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await N(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Je})}catch(i){if($(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=qs(e,["options"]),n=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(n.new_email=i==null?void 0:i.newEmail,delete n.newEmail),await N(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:$u,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if($(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await N(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Je})}catch(t){if($(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,n,o,l,u,d;try{const f={nextPage:null,lastPage:0,total:0},g=await N(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(o=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:to});if(g.error)throw g.error;const b=await g.json(),y=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,_=(d=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return _.length>0&&(_.forEach(w=>{const S=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(w.split(";")[1].split("=")[1]);f[`${O}Page`]=S}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},b),f),error:null}}catch(f){if($(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){xt(e);try{return await N(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Je})}catch(t){if($(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){xt(e);try{return await N(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Je})}catch(i){if($(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){xt(e);try{return await N(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Je})}catch(i){if($(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){xt(e.userId);try{const{data:t,error:i}=await N(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:i}}catch(t){if($(t))return{data:null,error:t};throw t}}async _deleteFactor(e){xt(e.userId),xt(e.id);try{return{data:await N(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if($(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,i,n,o,l,u,d;try{const f={nextPage:null,lastPage:0,total:0},g=await N(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(o=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:to});if(g.error)throw g.error;const b=await g.json(),y=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,_=(d=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&d!==void 0?d:[];return _.length>0&&(_.forEach(w=>{const S=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),O=JSON.parse(w.split(";")[1].split("=")[1]);f[`${O}Page`]=S}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},b),f),error:null}}catch(f){if($(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(e){try{return await N(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if($(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await N(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if($(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await N(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if($(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await N(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if($(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await N(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if($(t))return{data:null,error:t};throw t}}}function so(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}const $t={debug:!!(globalThis&&yo()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class wo extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ro extends wo{}async function Nu(s,e,t){$t.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const i=new globalThis.AbortController;e>0&&setTimeout(()=>{i.abort(),$t.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve();try{return await globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async n=>{if(n){$t.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,n.name);try{return await t()}finally{$t.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,n.name)}}else{if(e===0)throw $t.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new ro(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if($t.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}})}catch(n){throw(n==null?void 0:n.name)==="AbortError"?new ro(`Acquiring an exclusive Navigator LockManager lock "${s}" timed out waiting ${e}ms`):n}}function Du(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Eo(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function Uu(s){return parseInt(s,16)}function Bu(s){const e=new TextEncoder().encode(s);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function Mu(s){var e;const{chainId:t,domain:i,expirationTime:n,issuedAt:o=new Date,nonce:l,notBefore:u,requestId:d,resources:f,scheme:g,uri:b,version:y}=s;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!b)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((e=s.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const _=Eo(s.address),w=g?`${g}://${i}`:i,S=s.statement?`${s.statement}
`:"",O=`${w} wants you to sign in with your Ethereum account:
${_}

${S}`;let C=`URI: ${b}
Version: ${y}
Chain ID: ${t}${l?`
Nonce: ${l}`:""}
Issued At: ${o.toISOString()}`;if(n&&(C+=`
Expiration Time: ${n.toISOString()}`),u&&(C+=`
Not Before: ${u.toISOString()}`),d&&(C+=`
Request ID: ${d}`),f){let P=`
Resources:`;for(const T of f){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);P+=`
- ${T}`}C+=P}return`${O}
${C}`}class oe extends Error{constructor({message:e,code:t,cause:i,name:n}){var o;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(o=n??(i instanceof Error?i.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=t}}class Bs extends oe{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function qu({error:s,options:e}){var t,i,n;const{publicKey:o}=e;if(!o)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new oe({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((t=o.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new oe({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(e.mediation==="conditional"&&((i=o.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new oe({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new oe({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new oe({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new oe({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return o.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new oe({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new oe({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const l=window.location.hostname;if(ko(l)){if(o.rp.id!==l)return new oe({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new oe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new oe({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new oe({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new oe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function Fu({error:s,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new oe({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new oe({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const i=window.location.hostname;if(ko(i)){if(t.rpId!==i)return new oe({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new oe({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new oe({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new oe({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}class Wu{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Hu=new Wu;function Ku(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:e,user:t,excludeCredentials:i}=s,n=qs(s,["challenge","user","excludeCredentials"]),o=Bt(e).buffer,l=Object.assign(Object.assign({},t),{id:Bt(t.id).buffer}),u=Object.assign(Object.assign({},n),{challenge:o,user:l});if(i&&i.length>0){u.excludeCredentials=new Array(i.length);for(let d=0;d<i.length;d++){const f=i[d];u.excludeCredentials[d]=Object.assign(Object.assign({},f),{id:Bt(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return u}function Vu(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:e,allowCredentials:t}=s,i=qs(s,["challenge","allowCredentials"]),n=Bt(e).buffer,o=Object.assign(Object.assign({},i),{challenge:n});if(t&&t.length>0){o.allowCredentials=new Array(t.length);for(let l=0;l<t.length;l++){const u=t[l];o.allowCredentials[l]=Object.assign(Object.assign({},u),{id:Bt(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function zu(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s;return{id:s.id,rawId:s.id,response:{attestationObject:dt(new Uint8Array(s.response.attestationObject)),clientDataJSON:dt(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Gu(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s,i=s.getClientExtensionResults(),n=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:dt(new Uint8Array(n.authenticatorData)),clientDataJSON:dt(new Uint8Array(n.clientDataJSON)),signature:dt(new Uint8Array(n.signature)),userHandle:n.userHandle?dt(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function ko(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function io(){var s,e;return!!(ue()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator==null?void 0:navigator.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Ju(s){try{const e=await navigator.credentials.create(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Bs("Browser returned unexpected credential type",e)}:{data:null,error:new Bs("Empty credential response",e)}}catch(e){return{data:null,error:qu({error:e,options:s})}}}async function Yu(s){try{const e=await navigator.credentials.get(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Bs("Browser returned unexpected credential type",e)}:{data:null,error:new Bs("Empty credential response",e)}}catch(e){return{data:null,error:Fu({error:e,options:s})}}}const Xu={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Qu={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ms(...s){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),t=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),i={};for(const n of s)if(n)for(const o in n){const l=n[o];if(l!==void 0)if(Array.isArray(l))i[o]=l;else if(t(l))i[o]=l;else if(e(l)){const u=i[o];e(u)?i[o]=Ms(u,l):i[o]=Ms(l)}else i[o]=l}return i}function Zu(s,e){return Ms(Xu,s,e||{})}function eh(s,e){return Ms(Qu,s,e||{})}class th{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:i,signal:n},o){var l;try{const{data:u,error:d}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!u)return{data:null,error:d};const f=n??Hu.createNewAbortSignal();if(u.webauthn.type==="create"){const{user:g}=u.webauthn.credential_options.publicKey;if(!g.name){const b=i;if(b)g.name=`${g.id}:${b}`;else{const _=(await this.client.getUser()).data.user,w=((l=_==null?void 0:_.user_metadata)===null||l===void 0?void 0:l.name)||(_==null?void 0:_.email)||(_==null?void 0:_.id)||"User";g.name=`${g.id}:${w}`}}g.displayName||(g.displayName=g.name)}switch(u.webauthn.type){case"create":{const g=Zu(u.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:b,error:y}=await Ju({publicKey:g,signal:f});return b?{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:b}},error:null}:{data:null,error:y}}case"request":{const g=eh(u.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:b,error:y}=await Yu(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:g,signal:f}));return b?{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:b}},error:null}:{data:null,error:y}}}}catch(u){return $(u)?{data:null,error:u}:{data:null,error:new ht("Unexpected error in challenge",u)}}}async _verify({challengeId:e,factorId:t,webauthn:i}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},o){if(!t)return{data:null,error:new os("rpId is required for WebAuthn authentication")};try{if(!io())return{data:null,error:new ht("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:i},signal:n},{request:o});if(!l)return{data:null,error:u};const{webauthn:d}=l;return this._verify({factorId:e,challengeId:l.challengeId,webauthn:{type:d.type,rpId:t,rpOrigins:i,credential_response:d.credential_response}})}catch(l){return $(l)?{data:null,error:l}:{data:null,error:new ht("Unexpected error in authenticate",l)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},o){if(!t)return{data:null,error:new os("rpId is required for WebAuthn registration")};try{if(!io())return{data:null,error:new ht("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this._enroll({friendlyName:e});if(!l)return await this.client.mfa.listFactors().then(g=>{var b;return(b=g.data)===null||b===void 0?void 0:b.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===e&&y.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g==null?void 0:g.id}):void 0),{data:null,error:u};const{data:d,error:f}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:t,rpOrigins:i},signal:n},{create:o});return d?this._verify({factorId:l.id,challengeId:d.challengeId,webauthn:{rpId:t,rpOrigins:i,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:f}}catch(l){return $(l)?{data:null,error:l}:{data:null,error:new ht("Unexpected error in register",l)}}}}Du();const sh={url:Zc,storageKey:eu,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tu,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4,skipAutoInitialize:!1};async function no(s,e,t){return await t()}const jt={};class as{get jwks(){var e,t;return(t=(e=jt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){jt[this.storageKey]=Object.assign(Object.assign({},jt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=jt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){jt[this.storageKey]=Object.assign(Object.assign({},jt[this.storageKey]),{cachedAt:e})}constructor(e){var t,i,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const o=Object.assign(Object.assign({},sh),e);if(this.storageKey=o.storageKey,this.instanceID=(t=as.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,as.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.instanceID>0&&ue()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=o.persistSession,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Lu({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=bo(o.fetch),this.lock=o.lock||no,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.throwOnError=o.throwOnError,this.lockAcquireTimeout=o.lockAcquireTimeout,o.lock?this.lock=o.lock:this.persistSession&&ue()&&(!((i=globalThis==null?void 0:globalThis.navigator)===null||i===void 0)&&i.locks)?this.lock=Nu:this.lock=no,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new th(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:yo()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=so(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=so(this.memoryStorage)),ue()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l);try{await this._notifyAllSubscribers(l.data.event,l.data.session,!1)}catch(u){this._debug("#broadcastChannel","error",u)}})}o.skipAutoInitialize||this.initialize().catch(l=>{this._debug("#initialize()","error",l)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${mo}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},i="none";if(ue()&&(t=gu(window.location.href),this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce")),ue()&&this.detectSessionInUrl&&i!=="none"){const{data:n,error:o}=await this._getSessionFromURL(t,i);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),ou(o)){const d=(e=o.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:o}}return{error:o}}const{session:l,redirectType:u}=n;return this._debug("#_initialize()","detected session in URL",l,"redirect type",u),await this._saveSession(l),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return $(t)?this._returnResult({error:t}):this._returnResult({error:new ht("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,n;try{const o=await N(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:Pe}),{data:l,error:u}=o;if(u||!l)return this._returnResult({data:{user:null,session:null},error:u});const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(o){if($(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(e){var t,i,n;try{let o;if("email"in e){const{email:g,password:b,options:y}=e;let _=null,w=null;this.flowType==="pkce"&&([_,w]=await It(this.storage,this.storageKey)),o=await N(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y==null?void 0:y.emailRedirectTo,body:{email:g,password:b,data:(t=y==null?void 0:y.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken},code_challenge:_,code_challenge_method:w},xform:Pe})}else if("phone"in e){const{phone:g,password:b,options:y}=e;o=await N(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:b,data:(i=y==null?void 0:y.data)!==null&&i!==void 0?i:{},channel:(n=y==null?void 0:y.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken}},xform:Pe})}else throw new Ls("You must provide either an email or phone number and a password");const{data:l,error:u}=o;if(u||!l)return await ce(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(o){if(await ce(this.storage,`${this.storageKey}-code-verifier`),$(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(e){try{let t;if("email"in e){const{email:o,password:l,options:u}=e;t=await N(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:l,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:eo})}else if("phone"in e){const{phone:o,password:l,options:u}=e;t=await N(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:l,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:eo})}else throw new Ls("You must provide either an email or phone number and a password");const{data:i,error:n}=t;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!i||!i.session||!i.user){const o=new Pt;return this._returnResult({data:{user:null,session:null},error:o})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:n})}catch(t){if($(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,i,n,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,i,n,o,l,u,d,f,g,b,y;let _,w;if("message"in e)_=e.message,w=e.signature;else{const{chain:S,wallet:O,statement:C,options:P}=e;let T;if(ue())if(typeof O=="object")T=O;else{const ge=window;if("ethereum"in ge&&typeof ge.ethereum=="object"&&"request"in ge.ethereum&&typeof ge.ethereum.request=="function")T=ge.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!(P!=null&&P.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=O}const q=new URL((t=P==null?void 0:P.url)!==null&&t!==void 0?t:window.location.href),re=await T.request({method:"eth_requestAccounts"}).then(ge=>ge).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!re||re.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const J=Eo(re[0]);let ie=(i=P==null?void 0:P.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!ie){const ge=await T.request({method:"eth_chainId"});ie=Uu(ge)}const $e={domain:q.host,address:J,statement:C,uri:q.href,version:"1",chainId:ie,nonce:(n=P==null?void 0:P.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(l=(o=P==null?void 0:P.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(u=P==null?void 0:P.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(d=P==null?void 0:P.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(f=P==null?void 0:P.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(g=P==null?void 0:P.signInWithEthereum)===null||g===void 0?void 0:g.resources};_=Mu($e),w=await T.request({method:"personal_sign",params:[Bu(_),J]})}try{const{data:S,error:O}=await N(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:_,signature:w},!((b=e.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Pe});if(O)throw O;if(!S||!S.session||!S.user){const C=new Pt;return this._returnResult({data:{user:null,session:null},error:C})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:O})}catch(S){if($(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async signInWithSolana(e){var t,i,n,o,l,u,d,f,g,b,y,_;let w,S;if("message"in e)w=e.message,S=e.signature;else{const{chain:O,wallet:C,statement:P,options:T}=e;let q;if(ue())if(typeof C=="object")q=C;else{const J=window;if("solana"in J&&typeof J.solana=="object"&&("signIn"in J.solana&&typeof J.solana.signIn=="function"||"signMessage"in J.solana&&typeof J.solana.signMessage=="function"))q=J.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!(T!=null&&T.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");q=C}const re=new URL((t=T==null?void 0:T.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in q&&q.signIn){const J=await q.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T==null?void 0:T.signInWithSolana),{version:"1",domain:re.host,uri:re.href}),P?{statement:P}:null));let ie;if(Array.isArray(J)&&J[0]&&typeof J[0]=="object")ie=J[0];else if(J&&typeof J=="object"&&"signedMessage"in J&&"signature"in J)ie=J;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in ie&&"signature"in ie&&(typeof ie.signedMessage=="string"||ie.signedMessage instanceof Uint8Array)&&ie.signature instanceof Uint8Array)w=typeof ie.signedMessage=="string"?ie.signedMessage:new TextDecoder().decode(ie.signedMessage),S=ie.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in q)||typeof q.signMessage!="function"||!("publicKey"in q)||typeof q!="object"||!q.publicKey||!("toBase58"in q.publicKey)||typeof q.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${re.host} wants you to sign in with your Solana account:`,q.publicKey.toBase58(),...P?["",P,""]:[""],"Version: 1",`URI: ${re.href}`,`Issued At: ${(n=(i=T==null?void 0:T.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((o=T==null?void 0:T.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((l=T==null?void 0:T.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((u=T==null?void 0:T.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((d=T==null?void 0:T.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((f=T==null?void 0:T.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((b=(g=T==null?void 0:T.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||b===void 0)&&b.length?["Resources",...T.signInWithSolana.resources.map(ie=>`- ${ie}`)]:[]].join(`
`);const J=await q.signMessage(new TextEncoder().encode(w),"utf8");if(!J||!(J instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=J}}try{const{data:O,error:C}=await N(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:dt(S)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(_=e.options)===null||_===void 0?void 0:_.captchaToken}}:null),xform:Pe});if(C)throw C;if(!O||!O.session||!O.user){const P=new Pt;return this._returnResult({data:{user:null,session:null},error:P})}return O.session&&(await this._saveSession(O.session),await this._notifyAllSubscribers("SIGNED_IN",O.session)),this._returnResult({data:Object.assign({},O),error:C})}catch(O){if($(O))return this._returnResult({data:{user:null,session:null},error:O});throw O}}async _exchangeCodeForSession(e){const t=await lt(this.storage,`${this.storageKey}-code-verifier`),[i,n]=(t??"").split("/");try{if(!i&&this.flowType==="pkce")throw new au;const{data:o,error:l}=await N(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:Pe});if(await ce(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!o||!o.session||!o.user){const u=new Pt;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:n??null}),error:l})}catch(o){if(await ce(this.storage,`${this.storageKey}-code-verifier`),$(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(e){try{const{options:t,provider:i,token:n,access_token:o,nonce:l}=e,u=await N(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:n,access_token:o,nonce:l,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Pe}),{data:d,error:f}=u;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!d||!d.session||!d.user){const g=new Pt;return this._returnResult({data:{user:null,session:null},error:g})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:f})}catch(t){if($(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,i,n,o,l;try{if("email"in e){const{email:u,options:d}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await It(this.storage,this.storageKey));const{error:b}=await N(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:d==null?void 0:d.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:b})}if("phone"in e){const{phone:u,options:d}=e,{data:f,error:g}=await N(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(o=d==null?void 0:d.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:g})}throw new Ls("You must provide either an email or phone number.")}catch(u){if(await ce(this.storage,`${this.storageKey}-code-verifier`),$(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(e){var t,i;try{let n,o;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:l,error:u}=await N(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:n,xform:Pe});if(u)throw u;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,f=l.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:f,session:d},error:null})}catch(n){if($(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var t,i,n,o,l;try{let u=null,d=null;this.flowType==="pkce"&&([u,d]=await It(this.storage,this.storageKey));const f=await N(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:d}),headers:this.headers,xform:xu});return!((o=f.data)===null||o===void 0)&&o.url&&ue()&&!(!((l=e.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(u){if(await ce(this.storage,`${this.storageKey}-code-verifier`),$(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new be;const{error:n}=await N(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if($(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:n,options:o}=e,{error:l}=await N(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:n,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in e){const{phone:i,type:n,options:o}=e,{data:l,error:u}=await N(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:n,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:u})}throw new Ls("You must provide either an email or phone number and a type")}catch(t){if($(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await lt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<Ir:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const l=await lt(this.userStorage,this.storageKey+"-user");l!=null&&l.user?e.user=l.user:e.user=jr()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};e.user=Cu(e.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await N(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Je}):await this._useSession(async t=>{var i,n,o;const{data:l,error:u}=t;if(u)throw u;return!(!((i=l.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new be}:await N(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0,xform:Je})})}catch(t){if($(t))return xr(t)&&(await this._removeSession(),await ce(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:n,error:o}=i;if(o)throw o;if(!n.session)throw new be;const l=n.session;let u=null,d=null;this.flowType==="pkce"&&e.email!=null&&([u,d]=await It(this.storage,this.storageKey));const{data:f,error:g}=await N(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:u,code_challenge_method:d}),jwt:l.access_token,xform:Je});if(g)throw g;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(i){if(await ce(this.storage,`${this.storageKey}-code-verifier`),$(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new be;const t=Date.now()/1e3;let i=t,n=!0,o=null;const{payload:l}=Ds(e.access_token);if(l.exp&&(i=l.exp,n=i<=t),n){const{data:u,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!u)return{data:{user:null,session:null},error:null};o=u}else{const{data:u,error:d}=await this._getUser(e.access_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});o={access_token:e.access_token,refresh_token:e.refresh_token,user:u.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(t){if($(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:l,error:u}=t;if(u)throw u;e=(i=l.session)!==null&&i!==void 0?i:void 0}if(!(e!=null&&e.refresh_token))throw new be;const{data:n,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if($(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!ue())throw new Ns("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ns(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new zn("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ns("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new zn("No code detected.");const{data:P,error:T}=await this._exchangeCodeForSession(e.code);if(T)throw T;const q=new URL(window.location.href);return q.searchParams.delete("code"),window.history.replaceState(window.history.state,"",q.toString()),{data:{session:P.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:n,access_token:o,refresh_token:l,expires_in:u,expires_at:d,token_type:f}=e;if(!o||!u||!l||!f)throw new Ns("No session defined in URL");const g=Math.round(Date.now()/1e3),b=parseInt(u);let y=g+b;d&&(y=parseInt(d));const _=y-g;_*1e3<=Nt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${b}s`);const w=y-b;g-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,y,g):g-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,y,g);const{data:S,error:O}=await this._getUser(o);if(O)throw O;const C={provider_token:i,provider_refresh_token:n,access_token:o,expires_in:b,expires_at:y,refresh_token:l,token_type:f,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:C,redirectType:e.type},error:null})}catch(i){if($(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await lt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:n,error:o}=t;if(o&&!xr(o))return this._returnResult({error:o});const l=(i=n.session)===null||i===void 0?void 0:i.access_token;if(l){const{error:u}=await this.admin.signOut(l,e);if(u&&!(nu(u)&&(u.status===404||u.status===401||u.status===403)||xr(u)))return this._returnResult({error:u})}return e!=="others"&&(await this._removeSession(),await ce(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=pu(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,n;try{const{data:{session:o},error:l}=t;if(l)throw l;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,t={}){let i=null,n=null;this.flowType==="pkce"&&([i,n]=await It(this.storage,this.storageKey,!0));try{return await N(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(o){if(await ce(this.storage,`${this.storageKey}-code-verifier`),$(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if($(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:i,error:n}=await this._useSession(async o=>{var l,u,d,f,g;const{data:b,error:y}=o;if(y)throw y;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(u=e.options)===null||u===void 0?void 0:u.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await N(this.fetch,"GET",_,{headers:this.headers,jwt:(g=(f=b.session)===null||f===void 0?void 0:f.access_token)!==null&&g!==void 0?g:void 0})});if(n)throw n;return ue()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),this._returnResult({data:{provider:e.provider,url:i==null?void 0:i.url},error:null})}catch(i){if($(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var i;try{const{error:n,data:{session:o}}=t;if(n)throw n;const{options:l,provider:u,token:d,access_token:f,nonce:g}=e,b=await N(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=o==null?void 0:o.access_token)!==null&&i!==void 0?i:void 0,body:{provider:u,id_token:d,access_token:f,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Pe}),{data:y,error:_}=b;return _?this._returnResult({data:{user:null,session:null},error:_}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new Pt}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:_}))}catch(n){if(await ce(this.storage,`${this.storageKey}-code-verifier`),$(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,n;const{data:o,error:l}=t;if(l)throw l;return await N(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if($(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await vu(async n=>(n>0&&await _u(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await N(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Pe})),(n,o)=>{const l=200*Math.pow(2,n);return o&&$r(o)&&Date.now()+l-i<Nt})}catch(i){if(this._debug(t,"error",i),$(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),ue()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const n=await lt(this.storage,this.storageKey);if(n&&this.userStorage){let l=await lt(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:n.user},await Dt(this.userStorage,this.storageKey+"-user",l)),n.user=(e=l==null?void 0:l.user)!==null&&e!==void 0?e:jr()}else if(n&&!n.user&&!n.user){const l=await lt(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(n.user=l.user,await ce(this.storage,this.storageKey+"-user"),await Dt(this.storage,this.storageKey,n)):n.user=jr()}if(this._debug(i,"session from storage",n),!this._isValidSession(n)){this._debug(i,"session is not valid"),n!==null&&await this._removeSession();return}const o=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Ir;if(this._debug(i,`session has${o?"":" not"} expired with margin of ${Ir}s`),o){if(this.autoRefreshToken&&n.refresh_token){const{error:l}=await this._callRefreshToken(n.refresh_token);l&&(console.error(l),$r(l)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:u}=await this._getUser(n.access_token);!u&&(l!=null&&l.user)?(n.user=l.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(i,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(i,"error",n),console.error(n);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new be;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Hs;const{data:o,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!o.session)throw new be;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const u={data:o.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(o){if(this._debug(n,"error",o),$(o)){const l={data:null,error:o};return $r(o)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(l),l}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(o),o}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,i=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const o=[],l=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(e,t)}catch(d){o.push(d)}});if(await Promise.all(l),o.length>0){for(let u=0;u<o.length;u+=1)console.error(o[u]);throw o[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ce(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await Dt(this.userStorage,this.storageKey+"-user",{user:t.user});const n=Object.assign({},t);delete n.user;const o=Qn(n);await Dt(this.storage,this.storageKey,o)}else{const n=Qn(t);await Dt(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ce(this.storage,this.storageKey),await ce(this.storage,this.storageKey+"-code-verifier"),await ce(this.storage,this.storageKey+"-user"),this.userStorage&&await ce(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ue()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Nt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((i.expires_at*1e3-e)/Nt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Nt}ms, refresh threshold is ${Fr} ticks`),n<=Fr&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof wo)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ue()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const n=[`provider=${encodeURIComponent(t)}`];if(i!=null&&i.redirectTo&&n.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&n.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[o,l]=await It(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(l)}`});n.push(u.toString())}if(i!=null&&i.queryParams){const o=new URLSearchParams(i.queryParams);n.push(o.toString())}return i!=null&&i.skipBrowserRedirect&&n.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:n,error:o}=t;return o?this._returnResult({data:null,error:o}):await N(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=n==null?void 0:n.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if($(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,n;const{data:o,error:l}=t;if(l)return this._returnResult({data:null,error:l});const u=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:d,error:f}=await N(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(i=o==null?void 0:o.session)===null||i===void 0?void 0:i.access_token});return f?this._returnResult({data:null,error:f}):(e.factorType==="totp"&&d.type==="totp"&&(!((n=d==null?void 0:d.totp)===null||n===void 0)&&n.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(t){if($(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:n,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?zu(e.webauthn.credential_response):Gu(e.webauthn.credential_response)})}:{code:e.code}),{data:u,error:d}=await N(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:(i=n==null?void 0:n.session)===null||i===void 0?void 0:i.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:d}))})}catch(t){if($(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:n,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=await N(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=n==null?void 0:n.session)===null||i===void 0?void 0:i.access_token});if(l.error)return l;const{data:u}=l;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:Ku(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:Vu(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if($(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:i}=await this.getUser();if(i)return{data:null,error:i};const n={all:[],phone:[],totp:[],webauthn:[]};for(const o of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])n.all.push(o),o.status==="verified"&&n[o.factor_type].push(o);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,i,n,o;if(e)try{const{payload:_}=Ds(e);let w=null;_.aal&&(w=_.aal);let S=w;const{data:{user:O},error:C}=await this.getUser(e);if(C)return this._returnResult({data:null,error:C});((i=(t=O==null?void 0:O.factors)===null||t===void 0?void 0:t.filter(q=>q.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(S="aal2");const T=_.amr||[];return{data:{currentLevel:w,nextLevel:S,currentAuthenticationMethods:T},error:null}}catch(_){if($(_))return this._returnResult({data:null,error:_});throw _}const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=Ds(l.access_token);let f=null;d.aal&&(f=d.aal);let g=f;((o=(n=l.user.factors)===null||n===void 0?void 0:n.filter(_=>_.status==="verified"))!==null&&o!==void 0?o:[]).length>0&&(g="aal2");const y=d.amr||[];return{data:{currentLevel:f,nextLevel:g,currentAuthenticationMethods:y},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:i},error:n}=t;return n?this._returnResult({data:null,error:n}):i?await N(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new be})})}catch(t){if($(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:n},error:o}=i;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new be});const l=await N(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&ue()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(i){if($(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:n},error:o}=i;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new be});const l=await N(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&ue()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(i){if($(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;return i?this._returnResult({data:null,error:i}):t?await N(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new be})})}catch(e){if($(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:i},error:n}=t;return n?this._returnResult({data:null,error:n}):i?(await N(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new be})})}catch(t){if($(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(u=>u.kid===e);if(i)return i;const n=Date.now();if(i=this.jwks.keys.find(u=>u.kid===e),i&&this.jwks_cached_at+ru>n)return i;const{data:o,error:l}=await N(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=n,i=o.keys.find(u=>u.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:_,error:w}=await this.getSession();if(w||!_.session)return this._returnResult({data:null,error:w});i=_.session.access_token}const{header:n,payload:o,signature:l,raw:{header:u,payload:d}}=Ds(i);t!=null&&t.allowExpired||Tu(o.exp);const f=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!f){const{error:_}=await this.getUser(i);if(_)throw _;return{data:{claims:o,header:n,signature:l},error:null}}const g=Au(n.alg),b=await crypto.subtle.importKey("jwk",f,g,!0,["verify"]);if(!await crypto.subtle.verify(g,b,l,du(`${u}.${d}`)))throw new Kr("Invalid JWT signature");return{data:{claims:o,header:n,signature:l},error:null}}catch(i){if($(i))return this._returnResult({data:null,error:i});throw i}}}as.nextInstanceID={};const rh=as,ih="2.97.0";let Zt="";typeof Deno<"u"?Zt="deno":typeof document<"u"?Zt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Zt="react-native":Zt="node";const nh={"X-Client-Info":`supabase-js-${Zt}/${ih}`},oh={headers:nh},ah={schema:"public"},lh={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ch={};function ls(s){"@babel/helpers - typeof";return ls=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ls(s)}function uh(s,e){if(ls(s)!="object"||!s)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var i=t.call(s,e);if(ls(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function hh(s){var e=uh(s,"string");return ls(e)=="symbol"?e:e+""}function dh(s,e,t){return(e=hh(e))in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function oo(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),t.push.apply(t,i)}return t}function se(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?oo(Object(t),!0).forEach(function(i){dh(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):oo(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}const fh=s=>s?(...e)=>s(...e):(...e)=>fetch(...e),ph=()=>Headers,gh=(s,e,t)=>{const i=fh(t),n=ph();return async(o,l)=>{var u;const d=(u=await e())!==null&&u!==void 0?u:s;let f=new n(l==null?void 0:l.headers);return f.has("apikey")||f.set("apikey",s),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),i(o,se(se({},l),{},{headers:f}))}};function mh(s){return s.endsWith("/")?s:s+"/"}function _h(s,e){var t,i;const{db:n,auth:o,realtime:l,global:u}=s,{db:d,auth:f,realtime:g,global:b}=e,y={db:se(se({},d),n),auth:se(se({},f),o),realtime:se(se({},g),l),storage:{},global:se(se(se({},b),u),{},{headers:se(se({},(t=b==null?void 0:b.headers)!==null&&t!==void 0?t:{}),(i=u==null?void 0:u.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return s.accessToken?y.accessToken=s.accessToken:delete y.accessToken,y}function vh(s){const e=s==null?void 0:s.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(mh(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var yh=class extends rh{constructor(s){super(s)}},bh=class{constructor(s,e,t){var i,n;this.supabaseUrl=s,this.supabaseKey=e;const o=vh(s);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,u={db:ah,realtime:ch,auth:se(se({},lh),{},{storageKey:l}),global:oh},d=_h(t??{},u);if(this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(n=d.global.headers)!==null&&n!==void 0?n:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(g,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}});else{var f;this.auth=this._initSupabaseAuthClient((f=d.auth)!==null&&f!==void 0?f:{},this.headers,d.global.fetch)}this.fetch=gh(e,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(se({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new nc(new URL("rest/v1",o).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch,timeout:d.db.timeout,urlLengthLimit:d.db.urlLengthLimit}),this.storage=new Qc(this.storageUrl.href,this.headers,this.fetch,t==null?void 0:t.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new Xl(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(s,e,t)}channel(s,e={config:{}}){return this.realtime.channel(s,e)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var s=this,e,t;if(s.accessToken)return await s.accessToken();const{data:i}=await s.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:s.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:n,storageKey:o,flowType:l,lock:u,debug:d,throwOnError:f},g,b){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new yh({url:this.authUrl.href,headers:se(se({},y),g),storageKey:o,autoRefreshToken:s,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:n,flowType:l,lock:u,debug:d,throwOnError:f,fetch:b,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(s){return new Ec(this.realtimeUrl.href,se(se({},s),{},{params:se(se({},{apikey:this.supabaseKey}),s==null?void 0:s.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,e)=>{this._handleTokenChanged(s,"CLIENT",e==null?void 0:e.access_token)})}_handleTokenChanged(s,e,t){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):s==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const wh=(s,e,t)=>new bh(s,e,t);function Eh(){if(typeof window<"u")return!1;const s=globalThis.process;if(!s)return!1;const e=s.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Eh()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const kh="https://jfiwttjxervuexmcjtev.supabase.co",Sh="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpmaXd0dGp4ZXJ2dWV4bWNqdGV2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE1OTA3MTksImV4cCI6MjA4NzE2NjcxOX0.0hVveCNCakskndyleCE9PjfH2OSr4dEPdsALUYJIzZU",Th=wh(kh,Sh);export{Th as s};
