import{s as r}from"./supabaseClient-DBugF8ZN.js";document.addEventListener("DOMContentLoaded",async()=>{console.log("Landing page loaded successfully.");const{data:{session:e}}=await r.auth.getSession();if(e){document.getElementById("logged-out-view").style.display="none",document.getElementById("logged-in-view").style.display="block",document.getElementById("nav-dashboard").style.display="block",document.getElementById("nav-prompts").style.display="block",document.getElementById("nav-login").style.display="none",document.getElementById("nav-logout").style.display="block";const t=document.getElementById("user-email-display");t.textContent=e.user.email,document.getElementById("nav-user-email").style.display="block";const s=document.getElementById("nav-divider");s&&s.style.setProperty("display","flex","important"),await y(),p()}else document.getElementById("logged-out-view").style.display="flex",document.getElementById("logged-in-view").style.display="none";const n=document.getElementById("logout-btn");n&&n.addEventListener("click",async t=>{t.preventDefault(),await r.auth.signOut(),window.location.reload()})});async function y(){try{const{data:e,error:n}=await r.rpc("get_user_dashboard_stats");if(n)throw n;if(e&&e.length>0){const t=e[0];document.getElementById("stat-categories").textContent=t.total_categories||0,document.getElementById("stat-prompts").textContent=t.total_prompts||0,document.getElementById("stat-recent").textContent=t.recently_added||0}}catch(e){console.error("Error fetching dashboard stats:",e.message)}}function p(){const e=document.getElementById("global-search-form"),n=document.getElementById("global-search-input"),t=document.getElementById("search-results-container"),s=document.getElementById("search-results-list");e.addEventListener("submit",async u=>{u.preventDefault();const d=n.value.trim();if(!d){t.style.display="none";return}try{const o=d.replace(/,/g," "),{data:c,error:m}=await r.from("prompts").select("id, title, prompt_text, category_id, categories(name)").or(`title.ilike.%${o}%,prompt_text.ilike.%${o}%,result_text.ilike.%${o}%`).order("created_at",{ascending:!1}).limit(10);if(m)throw m;s.innerHTML="",c.length===0?s.innerHTML='<div class="list-group-item text-muted">No prompts found matching your search.</div>':c.forEach(a=>{const g=a.categories?a.categories.name:"Uncategorized",l=document.createElement("a");l.href=`./pages/prompts/prompts.html?id=${a.id}&category=${a.category_id}`,l.className="list-group-item list-group-item-action flex-column align-items-start",l.innerHTML=`
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1 text-primary">${i(a.title)}</h5>
              <small class="text-muted"><span class="badge bg-secondary">${i(g)}</span></small>
            </div>
            <p class="mb-1 text-truncate">${i(a.prompt_text||"")}</p>
          `,s.appendChild(l)}),t.style.display="block"}catch(o){console.error("Error searching prompts:",o.message),s.innerHTML='<div class="list-group-item text-danger">An error occurred while searching.</div>',t.style.display="block"}})}function i(e){const n=document.createElement("div");return n.textContent=e,n.innerHTML}
